(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{1786:function(e,t,n){"use strict";var o=_(n(0)),r=_(n(14)),l=n(2),d=n(1),f=n(21),c=_(n(10)),h=_(n(76)),w=_(n(71)),v=_(n(30)),m=_(n(128)),y=_(n(149)),F=_(n(1787)),x=n(188);function _(e){return e&&e.__esModule?e:{default:e}}var C={"=":"filter-operation-equals","<>":"filter-operation-not-equals","<":"filter-operation-less","<=":"filter-operation-less-equal",">":"filter-operation-greater",">=":"filter-operation-greater-equal",default:"filter-operation-default",notcontains:"filter-operation-not-contains",contains:"filter-operation-contains",startswith:"filter-operation-starts-with",endswith:"filter-operation-ends-with",between:"filter-operation-between"},R={"=":"equal","<>":"notEqual","<":"lessThan","<=":"lessThanOrEqual",">":"greaterThan",">=":"greaterThanOrEqual",startswith:"startsWith",contains:"contains",notcontains:"notContains",endswith:"endsWith",between:"between"},O="filter-row",B="filter-range-overlay",T="filter-range-start",I="dx-editor-with-menu",V="dx-editor-container",E="dx-editor-cell",P="dx-highlight-outline",S="dx-focused",D="dx-filter-range-content",A="dx-filter-modified",k="input:not([type='hidden'])",K=["date","datetime","number"];function N(e){return"onClick"===e.option("filterRow.applyFilter")}var G=function(){var e=function(e){var t=e&&e.children(),n=t&&t.data("dxComponents"),o=n&&n.length&&t.data(n[0]);if(o instanceof m.default)return o},t=function(e,t){var o="",r="",d=n(e,t),f=w.default.getFormatOptionsByColumn(t,"filterRow");return Array.isArray(d)?(o=w.default.formatValue(d[0],f),""!==(r=w.default.formatValue(d[1],f))&&(o+=" - "+r)):(0,l.isDefined)(d)&&(o=w.default.formatValue(d,f)),o};function n(e,t){if(t)return N(e)&&void 0!==t.bufferedFilterValue?t.bufferedFilterValue:t.filterValue}var h=function(e,t){if(t)return N(e)&&void 0!==t.bufferedSelectedFilterOperation?t.bufferedSelectedFilterOperation:t.selectedFilterOperation},_=function(e,t,o){var r=e._columnsController.columnOption(t),l=n(e,r),d=o.closest("."+e.addWidgetPrefix(B)).length,f=o.hasClass(e.addWidgetPrefix(T));return l&&Array.isArray(l)&&"between"===h(e,r)?f?l[0]:l[1]:!d&&function(e,t){return!(t&&K.indexOf(t.dataType)>=0&&Array.isArray(e))&&void 0!==e}(l,r)?l:null},P=function(e,t){var o=""===t.value?null:t.value,r=t.container,d=e._columnsController.columnOption(t.column.index),f=_(e,d.index,r);((0,l.isDefined)(f)||(0,l.isDefined)(o))&&(e._applyFilterViewController.setHighLight(r,f!==o),e._columnsController.columnOption(d.index,N(e)?"bufferedFilterValue":"filterValue",function(e,t,o,r){if("between"===h(e,o)){var l=n(e,o);return r.hasClass(e.addWidgetPrefix(T))?[t,Array.isArray(l)?l[1]:void 0]:[Array.isArray(l)?l[0]:l,t]}return t}(e,o,d,r),t.notFireEvent))};return{_updateEditorValue:function(t,n){var o=e(n);o&&o.option("value",_(this,t.index,n))},_columnOptionChanged:function(e){var n,r,l,d,f=this,c=e.optionNames;if(w.default.checkChanges(c,["filterValue","bufferedFilterValue","selectedFilterOperation","bufferedSelectedFilterOperation"])&&void 0!==e.columnIndex){var v=f._columnsController.getVisibleIndex(e.columnIndex),m=f._columnsController.columnOption(e.columnIndex);if(r=(n=f._getCellElement(f.element().find("."+f.addWidgetPrefix(O)).index(),v)||(0,o.default)()).find(".dx-editor-container").first(),c.filterValue||c.bufferedFilterValue){f._updateEditorValue(m,r);var y=n.find("."+f.addWidgetPrefix(B)).data("dxOverlay");y&&(l=y.$content().find(".dx-editor-container"),f._updateEditorValue(m,l.first()),f._updateEditorValue(m,l.last())),y&&y.option("visible")||f._updateFilterRangeContent(n,t(f,m))}(c.selectedFilterOperation||c.bufferedSelectedFilterOperation)&&v>=0&&m&&(d=n.find(".dx-menu")).length&&(f._updateFilterOperationChooser(d,m,r),"between"===h(f,m)?f._renderFilterRangeContent(n,m):r.find(".dx-filter-range-content").length&&(f._renderEditor(r,f._getEditorOptions(r,m)),f._hideFilterRange()))}else f.callBase(e)},_renderCore:function(){this._filterRangeOverlayInstance=null,this.callBase.apply(this,arguments)},_resizeCore:function(){this.callBase.apply(this,arguments),this._filterRangeOverlayInstance&&this._filterRangeOverlayInstance.repaint()},isFilterRowVisible:function(){return this._isElementVisible(this.option("filterRow"))},isVisible:function(){return this.callBase()||this.isFilterRowVisible()},init:function(){this.callBase(),this._applyFilterViewController=this.getController("applyFilter")},_initFilterRangeOverlay:function(e,n){var l=this,d={},c=e.find(".dx-editor-container"),w=(0,o.default)("<div>").addClass(l.addWidgetPrefix(B)).appendTo(e);return l._createComponent(w,y.default,{height:"auto",shading:!1,showTitle:!1,focusStateEnabled:!1,closeOnTargetScroll:!1,closeOnOutsideClick:!0,animation:!1,position:{my:"top",at:"top",of:c.length&&c||e,offset:"0 -1"},contentTemplate:function(t){var c,h=(0,o.default)("<div>").addClass("dx-editor-container "+l.addWidgetPrefix(T)).appendTo(t);return n=l._columnsController.columnOption(n.index),(c=l._getEditorOptions(h,n)).sharedData=d,l._renderEditor(h,c),r.default.on(h.find(k),"keydown",(function(t){var n=e.find("[tabindex]").not(t.target).first();"tab"===(0,f.normalizeKeyName)(t)&&t.shiftKey&&(t.preventDefault(),l._hideFilterRange(),n.length||(n=e.prev().find("[tabindex]").last()),r.default.trigger(n,"focus"))})),h=(0,o.default)("<div>").addClass("dx-editor-container "+l.addWidgetPrefix("filter-range-end")).appendTo(t),(c=l._getEditorOptions(h,n)).sharedData=d,l._renderEditor(h,c),r.default.on(h.find(k),"keydown",(function(t){"tab"!==(0,f.normalizeKeyName)(t)||t.shiftKey||(t.preventDefault(),l._hideFilterRange(),r.default.trigger(e.next().find("[tabindex]").first(),"focus"))})),(0,o.default)(t).addClass(l.getWidgetContainerClass())},onShown:function(e){var t=e.component.$content().find(".dx-editor-container").first();r.default.trigger(t.find(k),"focus")},onHidden:function(){n=l._columnsController.columnOption(n.index),e.find(".dx-menu").parent().addClass(I),"between"===h(l,n)&&(l._updateFilterRangeContent(e,t(l,n)),l.component.updateDimensions())}})},_updateFilterRangeOverlay:function(e){var t=this._filterRangeOverlayInstance;t&&t.option(e)},_showFilterRange:function(e,t){var n=this,o=e.children("."+n.addWidgetPrefix(B)),r=o.length&&o.data("dxOverlay");!r&&t&&(r=n._initFilterRangeOverlay(e,t)),r.option("visible")||(n._filterRangeOverlayInstance&&n._filterRangeOverlayInstance.hide(),n._filterRangeOverlayInstance=r,n._updateFilterRangeOverlay({width:e.outerWidth(!0)+1}),n._filterRangeOverlayInstance&&n._filterRangeOverlayInstance.show())},_hideFilterRange:function(){var e=this._filterRangeOverlayInstance;e&&e.hide()},getFilterRangeOverlayInstance:function(){return this._filterRangeOverlayInstance},_createRow:function(e){var t=this,n=this.callBase(e);return"filter"===e.rowType&&(n.addClass(this.addWidgetPrefix(O)),this.option("useLegacyKeyboardNavigation")||r.default.on(n,"keydown",(function(e){return(0,x.selectView)("filterRow",t,e)}))),n},_getRows:function(){var e=this.callBase();return this.isFilterRowVisible()&&e.push({rowType:"filter"}),e},_renderFilterCell:function(e,t){var n=this,r=t.column,l=(0,o.default)(e);n.component.option("showColumnHeaders")&&n.setAria("describedby",r.headerId,l),n.setAria("label",v.default.format("dxDataGrid-ariaFilterCell"),l),l.addClass(E);var d=(0,o.default)("<div>").appendTo(l),f=(0,o.default)("<div>").addClass(V).appendTo(d);if("between"===h(n,r))n._renderFilterRangeContent(l,r);else{var c=n._getEditorOptions(f,r);n._renderEditor(f,c)}var w=r.alignment;w&&"center"!==w&&l.find(k).first().css("textAlign",r.alignment),r.filterOperations&&r.filterOperations.length&&n._renderFilterOperationChooser(d,r,f)},_renderCellContent:function(e,t){var n=this,o=t.column;if("filter"===t.rowType)if(o.command)e.html("&nbsp;");else if(o.allowFiltering)return void n.renderTemplate(e,n._renderFilterCell.bind(n),t).done((function(){n._updateCell(e,t)}));n.callBase(e,t)},_getEditorOptions:function(e,t){var n=this,o={editorOptions:{inputAttr:n._getFilterInputAccessibilityAttributes(t)}},r=(0,d.extend)(o,t,{value:_(n,t.index,e),parentType:"filterRow",showAllText:n.option("filterRow.showAllText"),updateValueTimeout:"onClick"===n.option("filterRow.applyFilter")?0:700,width:null,setValue:function(o,r){P(n,{column:t,value:o,container:e,notFireEvent:r})}});return"between"===h(n,t)&&(e.hasClass(n.addWidgetPrefix(T))?r.placeholder=n.option("filterRow.betweenStartText"):r.placeholder=n.option("filterRow.betweenEndText")),r},_getFilterInputAccessibilityAttributes:function(e){var t=v.default.format("dxDataGrid-ariaFilterCell");return this.component.option("showColumnHeaders")?{"aria-label":t,"aria-describedby":e.headerId}:{"aria-label":t}},_renderEditor:function(e,t){return e.empty(),this.getController("editorFactory").createEditor((0,o.default)("<div>").appendTo(e),t)},_renderFilterRangeContent:function(e,n){var l=this,d=e.find(".dx-editor-container").first();d.empty();var f=(0,o.default)("<div>").addClass(D).attr("tabindex",this.option("tabIndex"));r.default.on(f,"focusin",(function(){l._showFilterRange(e,n)})),f.appendTo(d),l._updateFilterRangeContent(e,t(l,n))},_updateFilterRangeContent:function(e,t){var n=e.find(".dx-filter-range-content");n.length&&(""===t?n.html("&nbsp;"):n.text(t))},_updateFilterOperationChooser:function(t,n,o){var l,d=this,f=function(){var menu=F.default.getInstance(t);menu&&menu.option("focusedElement",null),l&&d._focusEditor(o)};d._createComponent(t,F.default,{integrationOptions:{},activeStateEnabled:!1,selectionMode:"single",cssClass:d.getWidgetContainerClass()+" dx-cell-focus-disabled dx-filter-menu",showFirstSubmenuMode:"onHover",hideSubmenuOnMouseLeave:!0,items:[{disabled:!n.filterOperations||!n.filterOperations.length,icon:C[h(d,n)||"default"],selectable:!1,items:d._getFilterOperationMenuItems(n)}],onItemClick:function(t){var r=t.itemData.name,l=h(d,n),f=!1,c=N(d),w={};if(!(t.itemData.items||r&&r===l)){if(r?(w[c?"bufferedSelectedFilterOperation":"selectedFilterOperation"]=r,"between"!==r&&"between"!==l||(f="between"===r,w[c?"bufferedFilterValue":"filterValue"]=null)):(w[c?"bufferedFilterValue":"filterValue"]=null,w[c?"bufferedSelectedFilterOperation":"selectedFilterOperation"]=n.defaultSelectedFilterOperation||null),d._columnsController.columnOption(n.index,w),d._applyFilterViewController.setHighLight(o,!0),!r){var v=e(o);v&&"dxDateBox"===v.NAME&&!v.option("isValid")&&(v.reset(),v.option("isValid",!0))}f?d._showFilterRange(o.closest(".dx-editor-cell"),n):d._focusEditor(o)}},onSubmenuShown:function(){l=d._isEditorFocused(o),d.getController("editorFactory").loseFocus()},onSubmenuHiding:function(){r.default.trigger(t,"blur"),f()},onContentReady:function(e){r.default.on(t,"blur",(function(){var menu=e.component;menu._hideSubmenu(menu._visibleSubmenu),f()}))},rtlEnabled:d.option("rtlEnabled")})},_isEditorFocused:function(e){return e.hasClass(S)||e.parents(".dx-focused").length},_focusEditor:function(e){this.getController("editorFactory").focus(e),r.default.trigger(e.find(k),"focus")},_renderFilterOperationChooser:function(e,t,n){var r;this.option("filterRow.showOperationChooser")&&(e.addClass(I),r=(0,o.default)("<div>").prependTo(e),this._updateFilterOperationChooser(r,t,n))},_getFilterOperationMenuItems:function(e){var t=this,n=[{}],o=t.option("filterRow"),r=o&&o.operationDescriptions||{};if(e.filterOperations&&e.filterOperations.length){var d=e.filterOperations.filter((function(e){return(0,l.isDefined)(R[e])}));(n=c.default.map(d,(function(n){var o=R[n];return{name:n,selected:(h(t,e)||e.defaultFilterOperation)===n,text:r[o],icon:C[n]}}))).push({name:null,text:o&&o.resetOperationText,icon:C.default})}return n},optionChanged:function(e){switch(e.name){case"filterRow":case"showColumnLines":this._invalidate(!0,!0),e.handled=!0;break;default:this.callBase(e)}}}}(),H={skipCalculateColumnFilters:function(){return!1},_calculateAdditionalFilter:function(){if(this.skipCalculateColumnFilters())return this.callBase();var e=[this.callBase()],t=this._columnsController.getVisibleColumns(null,!0);return c.default.each(t,(function(){if(this.allowFiltering&&this.calculateFilterExpression&&(0,l.isDefined)(this.filterValue)){var filter=this.createFilterExpression(this.filterValue,this.selectedFilterOperation||this.defaultFilterOperation,"filterRow");e.push(filter)}})),w.default.combineFilters(e)}};t.ApplyFilterViewController=h.default.ViewController.inherit({_getHeaderPanel:function(){return this._headerPanel||(this._headerPanel=this.getView("headerPanel")),this._headerPanel},setHighLight:function(e,t){N(this)&&(e&&e.toggleClass(P,t)&&e.closest(".dx-editor-cell").toggleClass(A,t),this._getHeaderPanel().enableApplyButton(t))},applyFilter:function(){var e=this.getController("columns"),t=e.getColumns();e.beginUpdate();for(var i=0;i<t.length;i++){var n=t[i];void 0!==n.bufferedFilterValue&&(e.columnOption(i,"filterValue",n.bufferedFilterValue),n.bufferedFilterValue=void 0),void 0!==n.bufferedSelectedFilterOperation&&(e.columnOption(i,"selectedFilterOperation",n.bufferedSelectedFilterOperation),n.bufferedSelectedFilterOperation=void 0)}e.endUpdate(),this.removeHighLights()},removeHighLights:function(){if(N(this)){var e=this.getView("columnHeadersView").element();e.find("."+this.addWidgetPrefix(O)+" ."+P).removeClass(P),e.find("."+this.addWidgetPrefix(O)+" ."+A).removeClass(A),this._getHeaderPanel().enableApplyButton(!1)}}}),e.exports={defaultOptions:function(){return{filterRow:{visible:!1,showOperationChooser:!0,showAllText:v.default.format("dxDataGrid-filterRowShowAllText"),resetOperationText:v.default.format("dxDataGrid-filterRowResetOperationText"),applyFilter:"auto",applyFilterText:v.default.format("dxDataGrid-applyFilterText"),operationDescriptions:{equal:v.default.format("dxDataGrid-filterRowOperationEquals"),notEqual:v.default.format("dxDataGrid-filterRowOperationNotEquals"),lessThan:v.default.format("dxDataGrid-filterRowOperationLess"),lessThanOrEqual:v.default.format("dxDataGrid-filterRowOperationLessOrEquals"),greaterThan:v.default.format("dxDataGrid-filterRowOperationGreater"),greaterThanOrEqual:v.default.format("dxDataGrid-filterRowOperationGreaterOrEquals"),startsWith:v.default.format("dxDataGrid-filterRowOperationStartsWith"),contains:v.default.format("dxDataGrid-filterRowOperationContains"),notContains:v.default.format("dxDataGrid-filterRowOperationNotContains"),endsWith:v.default.format("dxDataGrid-filterRowOperationEndsWith"),between:v.default.format("dxDataGrid-filterRowOperationBetween"),isBlank:v.default.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:v.default.format("dxFilterBuilder-filterOperationIsNotBlank")},betweenStartText:v.default.format("dxDataGrid-filterRowOperationBetweenStartText"),betweenEndText:v.default.format("dxDataGrid-filterRowOperationBetweenEndText")}}},controllers:{applyFilter:t.ApplyFilterViewController},extenders:{controllers:{data:H,columnsResizer:{_startResizing:function(){var e=this;if(e.callBase.apply(e,arguments),e.isResizing()){var t=e._columnHeadersView.getFilterRangeOverlayInstance();if(t){var n=t.$element().closest("td").index();n!==e._targetPoint.columnIndex&&n!==e._targetPoint.columnIndex+1||t.$content().hide()}}},_endResizing:function(){var e,t=this;if(t.isResizing()){var n=t._columnHeadersView.getFilterRangeOverlayInstance();n&&(e=n.$element().closest("td"),t._columnHeadersView._updateFilterRangeOverlay({width:e.outerWidth(!0)+1}),n.$content().show())}t.callBase.apply(t,arguments)}}},views:{columnHeadersView:G,headerPanel:{_getToolbarItems:function(){var e=this.callBase();return this._prepareFilterItem(e).concat(e)},_prepareFilterItem:function(){var e=this,t=[];if(e._isShowApplyFilterButton()){var n=e.option("filterRow.applyFilterText"),r={widget:"dxButton",options:{icon:"apply-filter",disabled:!e._columnsController.getColumns().filter((function(e){return void 0!==e.bufferedFilterValue})).length,onClick:function(){e._applyFilterViewController.applyFilter()},hint:n,text:n,onInitialized:function(t){(0,o.default)(t.element).addClass(e._getToolbarButtonClass("dx-apply-button"))}},showText:"inMenu",name:"applyFilterButton",location:"after",locateInMenu:"auto",sortIndex:10};t.push(r)}return t},_isShowApplyFilterButton:function(){var e=this.option("filterRow");return e&&e.visible&&"onClick"===e.applyFilter},init:function(){this.callBase(),this._dataController=this.getController("data"),this._applyFilterViewController=this.getController("applyFilter")},enableApplyButton:function(e){this.setToolbarItemDisabled("applyFilterButton",!e)},isVisible:function(){return this.callBase()||this._isShowApplyFilterButton()},optionChanged:function(e){"filterRow"===e.name?(this._invalidate(),e.handled=!0):this.callBase(e)}}}}}},1794:function(e,t,n){"use strict";var o=n(2),r=w(n(76)),l=w(n(435)),d=w(n(56)),f=w(n(71)),c=w(n(342)),h=w(n(1797));function w(e){return e&&e.__esModule?e:{default:e}}var v=["=","<>","<","<=",">",">=","notcontains","contains","startswith","endswith","between"],m="include",y="exclude";function F(e){return e.dataField||e.name}var x,_,C,R,O,B,T=r.default.Controller.inherit((x=function(){return{filterType:m,filterValues:void 0}},_=function(e){return!(c.default.getGroupInterval(e)||e.headerFilter&&e.headerFilter.dataSource)},C=function(e){var t=e.filterValue;if((0,o.isDefined)(t)){var n=e.selectedFilterOperation||e.defaultFilterOperation||l.default.getDefaultOperation(e);return[F(e),n,e.filterValue]}return null},R=function(e){var t,n,o=e.filterValues;return o?(_(e)&&1===e.filterValues.length&&!Array.isArray(o[0])?(t=e.filterType===y?"<>":"=",n=o[0]):(t=e.filterType===y?"noneof":"anyof",n=o),[F(e),t,n]):null},O=function(e,t,n){var o=function(e,t){if(!e)return x();var n,o=e[1],r=e[2],l=Array.isArray(r);if(!l&&!_(t))return x();switch(o){case"anyof":case"=":n=m;break;case"noneof":case"<>":n=y;break;default:return x()}return{filterType:n,filterValues:l?r:[r]}}(n,t);e.columnOption(F(t),o)},B=function(e,t,n){var r,l=n&&n[1],d=t.filterOperations||t.defaultFilterOperations;(!d||d.indexOf(l)>=0||l===t.defaultFilterOperation)&&v.indexOf(l)>=0?(l!==t.defaultFilterOperation||(0,o.isDefined)(t.selectedFilterOperation)||(l=t.selectedFilterOperation),r={filterValue:n[2],selectedFilterOperation:l}):r={filterValue:void 0,selectedFilterOperation:void 0},e.columnOption(F(t),r)},{syncFilterValue:function(){var e=this,t=e.getController("columns"),n=t.getFilteringColumns();this._skipSyncColumnOptions=!0,n.forEach((function(n){var r=l.default.getMatchedConditions(e.option("filterValue"),F(n));if(1===r.length){var d=r[0];O(t,n,d),B(t,n,d)}else(0,o.isDefined)(n.filterValues)&&O(t,n),(0,o.isDefined)(n.filterValue)&&B(t,n)})),this._skipSyncColumnOptions=!1},_initSync:function(){var e=this.getController("columns").getColumns(),t=this.getController("data"),n=t.pageIndex();if(function(e){e.forEach((function(e){var t=F(e);if(!(0,o.isDefined)(t)&&e.allowFiltering)throw new d.default.Error("E1049",e.caption)}))}(e),!this.option("filterValue")){var r=this.getController("columns").getFilteringColumns(),l=this.getFilterValueFromColumns(r);this.option("filterValue",l)}this.syncFilterValue(),t.pageIndex(n)},init:function(){var e=this,t=this.getController("data");t.isFilterSyncActive()&&(this.getController("columns").isAllDataTypesDefined()?this._initSync():t.dataSourceChanged.add((function(){return e._initSync()})))},_getSyncFilterRow:function(e,t){var filter=C(t);return(0,o.isDefined)(filter)?l.default.syncFilters(e,filter):l.default.removeFieldConditionsFromFilter(e,F(t))},_getSyncHeaderFilter:function(e,t){var filter=R(t);return filter?l.default.syncFilters(e,filter):l.default.removeFieldConditionsFromFilter(e,F(t))},getFilterValueFromColumns:function(e){if(!this.getController("data").isFilterSyncActive())return null;var t=["and"];return e&&e.forEach((function(e){var n=R(e),o=C(e);n&&l.default.addItem(n,t),o&&l.default.addItem(o,t)})),l.default.getNormalizedFilter(t)},syncFilterRow:function(e,t){this.option("filterValue",this._getSyncFilterRow(this.option("filterValue"),e))},syncHeaderFilter:function(e){this.option("filterValue",this._getSyncHeaderFilter(this.option("filterValue"),e))},getCustomFilterOperations:function(){var e=this.option("filterBuilder.customOperations")||[];return[h.default.anyOf(this.component),h.default.noneOf(this.component)].concat(e)},publicMethods:function(){return["getCustomFilterOperations"]}})),I={isFilterSyncActive:function(){var e=this.option("filterSyncEnabled");return"auto"===e?this.option("filterPanel.visible"):e},skipCalculateColumnFilters:function(){return(0,o.isDefined)(this.option("filterValue"))&&this.isFilterSyncActive()},_calculateAdditionalFilter:function(){var e=this;if(!1===e.option("filterPanel.filterEnabled"))return e.callBase();var t=[e.callBase()],n=e.getController("columns").getFilteringColumns(),o=e.option("filterValue");if(e.isFilterSyncActive()){var r=e.getController("headerFilter").getCurrentColumn();r&&o&&(o=l.default.removeFieldConditionsFromFilter(o,F(r)))}var d=e.getController("filterSync").getCustomFilterOperations(),c=l.default.getFilterExpression(o,n,d,"filterBuilder");return c&&t.push(c),f.default.combineFilters(t)},_parseColumnPropertyName:function(e){return e.match(/.*\.(.*)/)[1]},clearFilter:function(e){this.component.beginUpdate(),arguments.length>0?("filterValue"===e&&this.option("filterValue",null),this.callBase(e)):(this.option("filterValue",null),this.callBase()),this.component.endUpdate()},optionChanged:function(e){switch(e.name){case"filterValue":this._applyFilter(),this.isFilterSyncActive()&&this.getController("filterSync").syncFilterValue(),e.handled=!0;break;case"filterSyncEnabled":e.handled=!0;break;case"columns":if(this.isFilterSyncActive()){var t=this.getController("columns").getColumnByPath(e.fullName),n=this.getController("filterSync");if(t&&!n._skipSyncColumnOptions){var o=this._parseColumnPropertyName(e.fullName);n._skipSyncColumnOptions=!0,"filterType"===o?y!==e.value&&y!==e.previousValue||n.syncHeaderFilter(t):"filterValues"===o?n.syncHeaderFilter(t):["filterValue","selectedFilterOperation"].indexOf(o)>-1&&n.syncFilterRow(t,t.filterValue),n._skipSyncColumnOptions=!1}}this.callBase(e);break;default:this.callBase(e)}}},V={_isHeaderFilterEmpty:function(e){return this.getController("data").isFilterSyncActive()?!l.default.filterHasField(this.option("filterValue"),F(e)):this.callBase(e)},_needUpdateFilterIndicators:function(){return!this.getController("data").isFilterSyncActive()},optionChanged:function(e){"filterValue"===e.name?this._updateHeaderFilterIndicators():this.callBase(e)}};e.exports={defaultOptions:function(){return{filterValue:null,filterSyncEnabled:"auto"}},controllers:{filterSync:T},extenders:{controllers:{data:I},views:{columnHeadersView:V}}}},1797:function(e,t,n){"use strict";var o=n(1121),r=n(0),l=n(30),d=n(1).extend,f=n(214).DataSource,c=n(19),h=n(435);function w(e){var t=function(e,t){return t?t+"/"+e:e},n=function e(n,o){var r=[];return n.forEach((function(n){if(n.items){var l=e(n.items,t(n.text,o));r=r.concat(l)}n.selected&&r.push(t(n.text,o))})),r},l=e&&e.getController("headerFilter");return{dataTypes:["string","date","datetime","number","boolean","object"],calculateFilterExpression:function(e,t,n){var o=[],r=e.length-1;return e&&e.forEach((function(e,l){if(h.isCondition(e)||h.isGroup(e)){var d=h.getFilterExpression(e,n,[],"headerFilter");o.push(d)}else o.push(h.getFilterExpression([t.dataField,"=",e],n,[],"headerFilter"));l!==r&&o.push("or")})),1===o.length&&(o=o[0]),o},editorTemplate:function(t,n){var div=r("<div>").addClass("dx-filterbuilder-item-value-text").appendTo(n),f=d(!0,{},e.columnOption(t.field.dataField));(0,o.renderValueText)(div,t.text&&t.text.split("|"));return f.filterType="include",f.filterValues=t.value?t.value.slice():[],l.showHeaderFilterMenuBase({columnElement:div,column:f,apply:function(){var e;e=this.filterValues,t.setValue(e),l.hideHeaderFilterMenu(),t.closeEditor()},onHidden:function(){t.closeEditor()},isFilterBuilder:!0}),n},customizeText:function(t){var o=t.value,r=e.columnOption(t.field.dataField),h=r&&r.headerFilter,w=r&&r.lookup;if(h&&h.dataSource||w&&w.dataSource){r=d({},r,{filterType:"include",filterValues:[o]});var v=l.getDataSource(r);v.paginate=!1;var m=new f(v),y=new c.Deferred,F=m.store().key();return F&&m.filter([F,"=",t.value]),m.load().done((function(e){y.resolve(n(e)[0])})),y}return l.getHeaderItemText(o,r,0,e.option("headerFilter"))}}}t.anyOf=function(e){return d(w(e),{name:"anyof",icon:"selectall",caption:l.format("dxFilterBuilder-filterOperationAnyOf")})},t.noneOf=function(e){var t=w(e);return d({},t,{calculateFilterExpression:function(e,n,o){var r=t.calculateFilterExpression(e,n,o);return r&&0!==r.length?"!"===r[0]?r:["!",r]:null},name:"noneof",icon:"unselectall",caption:l.format("dxFilterBuilder-filterOperationNoneOf")})}},1799:function(e,t,n){"use strict";var o=v(n(0)),r=v(n(76)),l=n(1),d=v(n(1800)),f=v(n(30)),c=v(n(424)),h=v(n(138)),w=n(188);function v(e){return e&&e.__esModule?e:{default:e}}var m=r.default.View.inherit({_renderCore:function(){this._updatePopupOptions()},_updatePopupOptions:function(){this.option("filterBuilderPopup.visible")?this._initPopup():this._filterBuilderPopup&&this._filterBuilderPopup.hide()},_disposePopup:function(){this._filterBuilderPopup&&(this._filterBuilderPopup.dispose(),this._filterBuilderPopup=void 0),this._filterBuilder&&(this._filterBuilder.dispose(),this._filterBuilder=void 0)},_initPopup:function(){var e=this;e._disposePopup(),e._filterBuilderPopup=e._createComponent(e.element(),h.default,(0,l.extend)({title:f.default.format("dxDataGrid-filterBuilderPopupTitle"),contentTemplate:function(t){return e._getPopupContentTemplate(t)},onOptionChanged:function(t){"visible"===t.name&&e.option("filterBuilderPopup.visible",t.value)},toolbarItems:e._getPopupToolbarItems()},e.option("filterBuilderPopup"),{onHidden:function(t){(0,w.restoreFocus)(e),e._disposePopup()}}))},_getPopupContentTemplate:function(e){var t=(0,o.default)(e),n=(0,o.default)("<div>").appendTo((0,o.default)(e));this._filterBuilder=this._createComponent(n,d.default,(0,l.extend)({value:this.option("filterValue"),fields:this.getController("columns").getFilteringColumns()},this.option("filterBuilder"),{customOperations:this.getController("filterSync").getCustomFilterOperations()})),this._createComponent(t,c.default,{direction:"both"})},_getPopupToolbarItems:function(){var e=this;return[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:f.default.format("OK"),onClick:function(t){var filter=e._filterBuilder.option("value");e.option("filterValue",filter),e._filterBuilderPopup.hide()}}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:f.default.format("Cancel"),onClick:function(t){e._filterBuilderPopup.hide()}}}]},optionChanged:function(e){switch(e.name){case"filterBuilder":case"filterBuilderPopup":this._invalidate(),e.handled=!0;break;default:this.callBase(e)}}});e.exports={defaultOptions:function(){return{filterBuilder:{groupOperationDescriptions:{and:f.default.format("dxFilterBuilder-and"),or:f.default.format("dxFilterBuilder-or"),notAnd:f.default.format("dxFilterBuilder-notAnd"),notOr:f.default.format("dxFilterBuilder-notOr")},filterOperationDescriptions:{between:f.default.format("dxFilterBuilder-filterOperationBetween"),equal:f.default.format("dxFilterBuilder-filterOperationEquals"),notEqual:f.default.format("dxFilterBuilder-filterOperationNotEquals"),lessThan:f.default.format("dxFilterBuilder-filterOperationLess"),lessThanOrEqual:f.default.format("dxFilterBuilder-filterOperationLessOrEquals"),greaterThan:f.default.format("dxFilterBuilder-filterOperationGreater"),greaterThanOrEqual:f.default.format("dxFilterBuilder-filterOperationGreaterOrEquals"),startsWith:f.default.format("dxFilterBuilder-filterOperationStartsWith"),contains:f.default.format("dxFilterBuilder-filterOperationContains"),notContains:f.default.format("dxFilterBuilder-filterOperationNotContains"),endsWith:f.default.format("dxFilterBuilder-filterOperationEndsWith"),isBlank:f.default.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:f.default.format("dxFilterBuilder-filterOperationIsNotBlank")}},filterBuilderPopup:{}}},views:{filterBuilderView:m}}},1802:function(e,t,n){"use strict";var o=F(n(0)),r=n(2),l=F(n(76)),d=F(n(71)),f=F(n(14)),c=F(n(30)),h=F(n(215)),w=F(n(435)),v=n(19),m=F(n(101)),y=n(648);function F(e){return e&&e.__esModule?e:{default:e}}var x="filter-panel",_=l.default.View.inherit({isVisible:function(){return this.option("filterPanel.visible")&&this.getController("data").dataSource()},init:function(){var e=this;this.getController("data").dataSourceChanged.add((function(){return e.render()}))},_renderCore:function(){var e=this,t=e.element();t.empty().addClass(e.addWidgetPrefix(x));var n=(0,o.default)("<div>").addClass(e.addWidgetPrefix("filter-panel-left")).appendTo(t);e.option("filterValue")||e._filterValueBuffer?(n.append(e._getCheckElement()).append(e._getFilterElement()).append(e._getTextElement()),t.append(e._getRemoveButtonElement())):n.append(e._getFilterElement()).append(e._getTextElement())},_getCheckElement:function(){var e=this,t=(0,o.default)("<div>").addClass(this.addWidgetPrefix("filter-panel-checkbox"));return e._createComponent(t,h.default,{value:e.option("filterPanel.filterEnabled"),onValueChanged:function(t){e.option("filterPanel.filterEnabled",t.value)}}),t.attr("title",this.option("filterPanel.texts.filterEnabledHint")),t},_getFilterElement:function(){var e=this,t=(0,o.default)("<div>").addClass("dx-icon-filter");return f.default.on(t,"click",(function(){return e._showFilterBuilder()})),(0,y.registerKeyboardAction)("filterPanel",e,t,void 0,(function(){return e._showFilterBuilder()})),e._addTabIndexToElement(t),t},_getTextElement:function(){var e,t=this,n=(0,o.default)("<div>").addClass(t.addWidgetPrefix("filter-panel-text")),r=t.option("filterValue");return r?(0,v.when)(t.getFilterText(r,t.getController("filterSync").getCustomFilterOperations())).done((function(e){var o=t.option("filterPanel.customizeText");if(o){var l=o({component:t.component,filterValue:r,text:e});"string"==typeof l&&(e=l)}n.text(e)})):(e=t.option("filterPanel.texts.createFilter"),n.text(e)),f.default.on(n,"click",(function(){return t._showFilterBuilder()})),(0,y.registerKeyboardAction)("filterPanel",t,n,void 0,(function(){return t._showFilterBuilder()})),t._addTabIndexToElement(n),n},_showFilterBuilder:function(){this.option("filterBuilderPopup.visible",!0)},_getRemoveButtonElement:function(){var e=this,t=function(){return e.option("filterValue",null)},n=(0,o.default)("<div>").addClass(e.addWidgetPrefix("filter-panel-clear-filter")).text(e.option("filterPanel.texts.clearFilter"));return f.default.on(n,"click",t),(0,y.registerKeyboardAction)("filterPanel",this,n,void 0,t),e._addTabIndexToElement(n),n},_addTabIndexToElement:function(e){if(!this.option("useLegacyKeyboardNavigation")){var t=this.option("tabindex")||0;e.attr("tabindex",t)}},optionChanged:function(e){switch(e.name){case"filterValue":this._invalidate(),this.option("filterPanel.filterEnabled",!0),e.handled=!0;break;case"filterPanel":this._invalidate(),e.handled=!0;break;default:this.callBase(e)}},_getConditionText:function(e,t,n){var o="[".concat(e,"] ").concat(t);return(0,r.isDefined)(n)&&(o+=n),o},_getValueMaskedText:function(e){return Array.isArray(e)?"('".concat(e.join("', '"),"')"):" '".concat(e,"'")},_getValueText:function(e,t,n){var o=this,l=new v.Deferred,f=t&&t.customizeText;if((0,r.isDefined)(n)||f)if(!f&&e.lookup)w.default.getCurrentLookupValueText(e,n,(function(data){l.resolve(o._getValueMaskedText(data))}));else{var c=Array.isArray(n)?n:d.default.getDisplayValue(e,n);(0,v.when)(w.default.getCurrentValueText(e,c,t,"filterPanel")).done((function(data){l.resolve(o._getValueMaskedText(data))}))}else l.resolve("");return l.promise()},getConditionText:function(e,t){var n,o=this,r=e[1],l=new v.Deferred,d=w.default.getCustomOperation(t.customOperations,r),f=w.default.getField(e[0],t.columns),c=f.caption||"",h=e[2];return n=d?d.caption||m.default.captionize(d.name):null===h?w.default.getCaptionByOperation("="===r?"isblank":"isnotblank",t.filterOperationDescriptions):w.default.getCaptionByOperation(r,t.filterOperationDescriptions),this._getValueText(f,d,h).done((function(e){l.resolve(o._getConditionText(c,n,e))})),l},getGroupText:function(e,t,n){var o=this,r=new v.Deferred,l=[],d=w.default.getGroupValue(e);return e.forEach((function(e){w.default.isCondition(e)?l.push(o.getConditionText(e,t)):w.default.isGroup(e)&&l.push(o.getGroupText(e,t,!0))})),v.when.apply(this,l).done((function(){for(var text,e=arguments.length,o=new Array(e),l=0;l<e;l++)o[l]=arguments[l];if("!"===d[0]){var f=t.groupOperationDescriptions["not"+d.substring(1,2).toUpperCase()+d.substring(2)].split(" ");text="".concat(f[0]," ").concat(o[0])}else text=o.join(" ".concat(t.groupOperationDescriptions[d]," "));n&&(text="(".concat(text,")")),r.resolve(text)})),r},getFilterText:function(e,t){var n=this,o={customOperations:t,columns:n.getController("columns").getFilteringColumns(),filterOperationDescriptions:n.option("filterBuilder.filterOperationDescriptions"),groupOperationDescriptions:n.option("filterBuilder.groupOperationDescriptions")};return w.default.isCondition(e)?n.getConditionText(e,o):n.getGroupText(e,o)}});e.exports={defaultOptions:function(){return{filterPanel:{visible:!1,filterEnabled:!0,texts:{createFilter:c.default.format("dxDataGrid-filterPanelCreateFilter"),clearFilter:c.default.format("dxDataGrid-filterPanelClearFilter"),filterEnabledHint:c.default.format("dxDataGrid-filterPanelFilterEnabledHint")}}}},views:{filterPanelView:_},extenders:{controllers:{data:{optionChanged:function(e){switch(e.name){case"filterPanel":this._applyFilter(),e.handled=!0;break;default:this.callBase(e)}}}}}}},1834:function(e,t,n){"use strict";var o=w(n(0)),r=w(n(76)),l=n(10),d=n(71),f=n(6),c=n(2),h=n(19);function w(e){return e&&e.__esModule?e:{default:e}}var v="dx-row-focused",m="dx-cell-focus-disabled";t.FocusController=r.default.ViewController.inherit({init:function(){this._dataController=this.getController("data"),this._keyboardController=this.getController("keyboardNavigation"),this.component._optionsByReference.focusedRowKey=!0},optionChanged:function(e){if("focusedRowIndex"===e.name){var t=this.option("focusedRowKey");this._focusRowByIndex(e.value),this._triggerFocusedRowChangedIfNeed(t,e.value),e.handled=!0}else if("focusedRowKey"===e.name){var n=this.option("focusedRowIndex");this._focusRowByKey(e.value),this._triggerFocusedRowChangedIfNeed(e.value,n),e.handled=!0}else"focusedColumnIndex"===e.name||"focusedRowEnabled"===e.name||"autoNavigateToFocusedRow"===e.name?e.handled=!0:this.callBase(e)},_triggerFocusedRowChangedIfNeed:function(e,t){if(t===this.getFocusedRowIndexByKey(e)){var n=this._dataController.getRowIndexByKey(e);if(n>=0){var r=(0,o.default)(this.getView("rowsView").getRowElement(n));this.getController("keyboardNavigation")._fireFocusedRowChanged(r,t)}}},isAutoNavigateToFocusedRow:function(){return"infinite"!==this.option("scrolling.mode")&&this.option("autoNavigateToFocusedRow")},_focusRowByIndex:function(e){this.option("focusedRowEnabled")&&((e=void 0!==e?e:this.option("focusedRowIndex"))<0?this.isAutoNavigateToFocusedRow()&&this._resetFocusedRow():this._focusRowByIndexCore(e))},_focusRowByIndexCore:function(e){var t=this,n=this.getController("data"),o=n.pageSize(),r=function(){if(t._isValidFocusedRowIndex(e)){var o=e-n.getRowIndexOffset(!0),r=n._getLastItemIndex(),l=Math.min(o,r),d=n.getKeyByRowIndex(l,!0);(0,c.isDefined)(d)&&!t.isRowFocused(d)&&t.option("focusedRowKey",d)}};if(o>=0)if(this._isLocalRowIndex(e))r();else{var l=Math.floor(e/n.pageSize());(0,h.when)(n.pageIndex(l),n.waitReady()).done((function(){r()}))}},_isLocalRowIndex:function(e){var t=this.getController("data");if(this.getController("keyboardNavigation")._isVirtualScrolling()){var n=Math.floor(e/t.pageSize()),o=t.virtualItemsCount(),r=o?o.begin:-1,l=t.getVisibleRows().length+t.getRowIndexOffset(),d=Math.ceil(l/t.pageSize());return r<=e&&d>n}return!0},_setFocusedRowKeyByIndex:function(e){var t=this.getController("data");if(this._isValidFocusedRowIndex(e)){var n=Math.min(e-t.getRowIndexOffset(),t.items().length-1),o=t.getKeyByRowIndex(n);(0,c.isDefined)(o)&&!this.isRowFocused(o)&&this.option("focusedRowKey",o)}},_focusRowByKey:function(e){(0,c.isDefined)(e)?this._navigateToRow(e,!0):this._resetFocusedRow()},_resetFocusedRow:function(){var e=this.option("focusedRowKey"),t=(0,c.isDefined)(e);if(t||!(this.option("focusedRowIndex")<0)){var n=this.getController("keyboardNavigation");t&&this.option("focusedRowKey",void 0),n.setFocusedRowIndex(-1),this.option("focusedRowIndex",-1),this.getController("data").updateItems({changeType:"updateFocusedRow",focusedRowKey:void 0}),n._fireFocusedRowChanged(void 0,-1)}},_isValidFocusedRowIndex:function(e){var t=this.getController("data").getVisibleRows()[e];return!t||"data"===t.rowType||"group"===t.rowType},publicMethods:function(){return["navigateToRow","isRowFocused"]},navigateToRow:function(e){this.isAutoNavigateToFocusedRow()||this.option("focusedRowIndex",-1),this._navigateToRow(e)},_navigateToRow:function(e,t){var n=this,o=n.getController("data"),r=n.isAutoNavigateToFocusedRow(),l=new h.Deferred;if(void 0===e||!o.dataSource())return l.reject().promise();var d=n.getFocusedRowIndexByKey(e);return!r&&t||d>=0?n._navigateTo(e,l,t):o.getPageIndexByKey(e).done((function(r){r<0?l.resolve(-1):r===o.pageIndex()?o.reload().done((function(){n.isRowFocused(e)?l.resolve(n.getFocusedRowIndexByKey(e)):n._navigateTo(e,l,t)})).fail(l.reject):o.pageIndex(r).done((function(){n._navigateTo(e,l,t)})).fail(l.reject)})).fail(l.reject),l.promise()},_navigateTo:function(e,t,n){var o=this.getController("data").getRowIndexByKey(e),r="virtual"===this.option("scrolling.rowRenderingMode");this.isAutoNavigateToFocusedRow()&&r&&o<0?this._navigateToVirtualRow(e,t,n):this._navigateToVisibleRow(e,t,n)},_navigateToVisibleRow:function(e,t,n){n?this._triggerUpdateFocusedRow(e,t):this.getView("rowsView").scrollToRowElement(e)},_navigateToVirtualRow:function(e,t,n){var o=this,r=this.getController("data"),l=r._rowsScrollController,f=(0,d.getIndexByKey)(e,r.items(!0)),c=o.getView("rowsView").getScrollable();if(l&&c&&f>=0){var h=f+r.getRowIndexOffset(!0),w=l.getItemOffset(h);n&&o.component.on("contentReady",(function n(){o.component.off("contentReady",n),o._triggerUpdateFocusedRow(e,t)})),c.scrollTo({y:w})}},_triggerUpdateFocusedRow:function(e,t){var n=this.getController("data"),o=this.getFocusedRowIndexByKey(e);this._isValidFocusedRowIndex(o)?(this.option("focusedRowEnabled")?n.updateItems({changeType:"updateFocusedRow",focusedRowKey:e}):this.getView("rowsView").scrollToRowElement(e),this.getController("keyboardNavigation").setFocusedRowIndex(o),t&&t.resolve(o)):t&&t.resolve(-1)},getFocusedRowIndexByKey:function(e){var t=this.getController("data"),n=t.getRowIndexByKey(e,!0);return n>=0?n+t.getRowIndexOffset(!0):-1},_focusRowByKeyOrIndex:function(){var e=this,t=this.option("focusedRowKey"),n=this.option("focusedRowIndex"),o=this.getController("keyboardNavigation"),r=this.getController("data");if((0,c.isDefined)(t)){var l=r.getRowIndexByKey(t);l>=0?(o._isVirtualScrolling()&&(n=l+r.getRowIndexOffset()),o.setFocusedRowIndex(n),this._triggerUpdateFocusedRow(t)):this._navigateToRow(t,!0).done((function(t){n>=0&&t<0&&e._focusRowByIndex()}))}else n>=0&&this.getController("focus")._focusRowByIndex(n)},isRowFocused:function(e){var t=this.option("focusedRowKey");if((0,c.isDefined)(t))return(0,f.equalByValue)(e,this.option("focusedRowKey"))},updateFocusedRow:function(e){var t,n=this,r=n._dataController.getRowIndexByKey(e.focusedRowKey),d=n.getView("rowsView");(0,l.each)(d.getTableElements(),(function(l,element){var d=0===l;t=(0,o.default)(element),n._clearPreviousFocusedRow(t,r),n._prepareFocusedRow({changedItem:e.items[r],$tableElement:t,focusedRowIndex:r,isMainTable:d})}))},_clearPreviousFocusedRow:function(e,t){var n=this,r=e.find(".dx-row.dx-row-focused").filter((function(t,r){var l=(0,o.default)(r).closest(".".concat(n.addWidgetPrefix("table")));return e.is(l)}));r.removeClass(v).removeClass(m).removeAttr("tabindex"),r.children("td").removeAttr("tabindex"),0!==t&&(0,o.default)(this.getView("rowsView").getRowElement(0)).removeClass(m).removeAttr("tabIndex")},_prepareFocusedRow:function(e){var t,n=e.changedItem;if(n&&("data"===n.rowType||"group"===n.rowType)){var r=e.focusedRowIndex,l=e.$tableElement,d=e.isMainTable,f=this.option("tabindex")||0,c=this.getView("rowsView");(t=(0,o.default)(c._getRowElements(l).eq(r))).addClass(v).attr("tabindex",f),d&&c.scrollToElementVertically(t)}return t}}),e.exports={defaultOptions:function(){return{focusedRowEnabled:!1,autoNavigateToFocusedRow:!0,focusedRowKey:void 0,focusedRowIndex:-1,focusedColumnIndex:-1}},controllers:{focus:t.FocusController},extenders:{controllers:{keyboardNavigation:{init:function(){var e=this.option("focusedRowIndex"),t=this.option("focusedColumnIndex");this.createAction("onFocusedRowChanging",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedRowChanged",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedCellChanging",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedCellChanged",{excludeValidators:["disabled","readOnly"]}),this.callBase(),this.setRowFocusType(),this._focusedCellPosition={},(0,c.isDefined)(e)&&(this._focusedCellPosition.rowIndex=this.option("focusedRowIndex")),(0,c.isDefined)(t)&&(this._focusedCellPosition.columnIndex=this.option("focusedColumnIndex"))},setFocusedRowIndex:function(e){var t=this.getController("data");this.callBase(e);var n=e-t.getRowIndexOffset(),o=t.getVisibleRows()[n];o&&o.isNewRow||this.option("focusedRowIndex",e)},setFocusedColumnIndex:function(e){this.callBase(e),this.option("focusedColumnIndex",e)},_escapeKeyHandler:function(e,t){!t&&this.option("focusedRowEnabled")?this.isCellFocusType()&&(this.setRowFocusType(),this._focus(this._getCellElementFromTarget(e.originalEvent.target),!0)):this.callBase(e,t)},_updateFocusedCellPosition:function(e,t){var n=this.option("focusedRowIndex"),o=this.option("focusedColumnIndex"),r=this.callBase(e,t);r&&r.columnIndex>=0&&this._fireFocusedCellChanged(e,o,n)}},editorFactory:{renderFocusOverlay:function(e,t){var n,o=this.getController("keyboardNavigation"),r=this.option("focusedRowEnabled"),l=this.getController("editing"),d="row"===o._getElementType(e);r&&o.isRowFocusType()&&!l.isEditing()?r&&d&&!e.hasClass(v)&&(n=o.getFirstValidCellInRow(e),o.focus(n)):this.callBase(e,t)}},columns:{getSortDataSourceParameters:function(e,t){var n=this,o=this.callBase.apply(this,arguments),r=this.getController("data"),l=r._dataSource,d=r.store(),f=d&&d.key(),c=l&&l.remoteOperations()||{},h=Object.keys(c).every((function(e){return!c[e]}));if(f&&(this.option("focusedRowEnabled")&&!1!==this.getController("focus").isAutoNavigateToFocusedRow()||t)){var w=(f=Array.isArray(f)?f:[f]).filter((function(e){return!n.columnOption(e,"sortOrder")}));w.length&&(o=o||[],h?o.push({selector:l.getDataIndexGetter(),desc:!1}):w.forEach((function(e){return o.push({selector:e,desc:!1})})))}return o}},data:{_applyChange:function(e){if(!e||"updateFocusedRow"!==e.changeType)return this.callBase.apply(this,arguments)},_fireChanged:function(e){if(this.callBase(e),this.option("focusedRowEnabled")&&this._dataSource){var t="update"===e.changeType&&e.repaintChangesOnly&&e.changeTypes&&e.changeTypes.indexOf("remove")>=0;"refresh"===e.changeType&&e.items.length||t?(this._updatePageIndexes(),this.processUpdateFocusedRow(e)):"append"!==e.changeType&&"prepend"!==e.changeType||this._updatePageIndexes()}},_updatePageIndexes:function(){var e=this._lastRenderingPageIndex||0,t=this._rowsScrollController?this._rowsScrollController.pageIndex():0;this._lastRenderingPageIndex=t,this._isPagingByRendering=t!==e},isPagingByRendering:function(){return this._isPagingByRendering},processUpdateFocusedRow:function(e){var t=e.operationTypes||{},n=this.getController("focus"),o=t.reload,r=t.fullReload,l=this.getController("keyboardNavigation")._isVirtualScrolling(),d=this.option("focusedRowKey"),f=n.isAutoNavigateToFocusedRow();if(o&&!r&&(0,c.isDefined)(d))n._navigateToRow(d,!0).done((function(e){e<0&&n._focusRowByIndex()}));else if(t.paging&&!l)if(f){var h=this.getRowIndexByKey(d),w=h>=0,v=this.option("focusedRowIndex");v>=0&&(v===h||!w)&&n._focusRowByIndex()}else this.getRowIndexByKey(d)<0&&this.option("focusedRowIndex",-1);else t.fullReload&&n._focusRowByKeyOrIndex()},getPageIndexByKey:function(e){var t=this,n=new h.Deferred;return t.getGlobalRowIndexByKey(e).done((function(e){n.resolve(e>=0?Math.floor(e/t.pageSize()):-1)})).fail(n.reject),n.promise()},getGlobalRowIndexByKey:function(e){return this._dataSource.group()?this._calculateGlobalRowIndexByGroupedData(e):this._calculateGlobalRowIndexByFlatData(e)},_calculateGlobalRowIndexByFlatData:function(e,t,n){var o=this,r=new h.Deferred,l=o._dataSource,filter=o._generateFilterByKey(e);return l.load({filter:o._concatWithCombinedFilter(filter),skip:0,take:1}).done((function(data){data.length>0?(filter=o._generateOperationFilterByKey(e,data[0],n),l.load({filter:o._concatWithCombinedFilter(filter,t),skip:0,take:1,requireTotalCount:!0}).done((function(e,t){r.resolve(t.totalCount)}))):r.resolve(-1)})),r.promise()},_concatWithCombinedFilter:function(filter,e){var t=this.getCombinedFilter();return(0,d.combineFilters)([filter,t,e])},_generateBooleanFilter:function(e,t,n){var o;return!1===t?o=[e,"=",!!n.desc||null]:(!0===t?!n.desc:n.desc)&&(o=[e,"<>",t]),o},_generateOperationFilterByKey:function(e,t,n){var o=this,r=o._dataSource,filter=o._generateFilterByKey(e,"<"),l=o._columnsController.getSortDataSourceParameters(!r.remoteOperations().filtering,!0);if(n){var d=o._columnsController.getGroupDataSourceParameters(!r.remoteOperations().filtering);d&&(l=l?d.concat(l):d)}return l&&l.slice().reverse().forEach((function(e){var n,r=e.selector,l=(n="function"==typeof r?r:o._columnsController.columnOption(r,"selector"))?n(t):t[r];if(filter=[[r,"=",l],"and",filter],null===l||(0,c.isBoolean)(l)){var d=o._generateBooleanFilter(r,l,e);d&&(filter=[d,"or",filter])}else{var f=[r,e.desc?">":"<",l];e.desc||(f=[f,"or",[r,"=",null]]),filter=[f,"or",filter]}})),filter},_generateFilterByKey:function(e,t){var n=this._dataSource.key(),filter=[];if(t||(t="="),Array.isArray(n))for(var i=0;i<n.length;++i){var o=e[n[i]];o&&(filter.length>0&&filter.push("and"),filter.push([n[i],t,o]))}else filter=[n,t,e];return filter},_getLastItemIndex:function(){return this.items(!0).length-1}},editing:{_deleteRowCore:function(e){var t=this,n=this.callBase.apply(this,arguments),o=this.getController("data"),r=o.getKeyByRowIndex(e);n.done((function(){var e=o.getRowIndexByKey(r),n=o.getVisibleRows();-1!==e||n.length||t.getController("focus")._resetFocusedRow()}))}}},views:{rowsView:{_createRow:function(e){var t=this.callBase(e);return this.option("focusedRowEnabled")&&e&&this.getController("focus").isRowFocused(e.key)&&t.addClass(v),t},_checkRowKeys:function(e){if(this.callBase.apply(this,arguments),this.option("focusedRowEnabled")&&this.option("dataSource")){var t=this._dataController.store();t&&!t.key()&&this._dataController.fireError("E1042","Row focusing")}},_update:function(e){"updateFocusedRow"===e.changeType?this.option("focusedRowEnabled")&&this.getController("focus").updateFocusedRow(e):this.callBase(e)},updateFocusElementTabIndex:function(e){this.option("focusedRowEnabled")?this._setFocusedRowElementTabIndex():this.callBase(e)},_setFocusedRowElementTabIndex:function(){var e=this,t=e.option("focusedRowKey"),n=e.option("tabIndex")||0,o=e._dataController,r=o.getRowIndexByKey(t),l=e.option("focusedColumnIndex"),d=e._findRowElementForTabIndex();if(e._scrollToFocusOnResize=e._scrollToFocusOnResize||function(){e.scrollToElementVertically(e._findRowElementForTabIndex()),e.resizeCompleted.remove(e._scrollToFocusOnResize)},d.attr("tabIndex",n),r>=0&&(l<0&&(l=0),r+=o.getRowIndexOffset(),e.getController("keyboardNavigation").setFocusedCellPosition(r,l),this.getController("focus").isAutoNavigateToFocusedRow())){var f=o.dataSource(),c=f&&f.operationTypes();!c||c.paging||o.isPagingByRendering()||(this.resizeCompleted.remove(this._scrollToFocusOnResize),this.resizeCompleted.add(this._scrollToFocusOnResize))}},_findRowElementForTabIndex:function(){var e=this.option("focusedRowKey"),t=this._dataController.getRowIndexByKey(e);return(0,o.default)(this.getRowElement(t>=0?t:0))},scrollToRowElement:function(e){var t=this.getController("data").getRowIndexByKey(e),n=(0,o.default)(this.getRow(t));this.scrollToElementVertically(n)},scrollToElementVertically:function(e){var t=this.getScrollable();if(t){var n=t.getScrollElementPosition(e,"vertical");t.scrollTo({top:n})}}}}}}}}]);