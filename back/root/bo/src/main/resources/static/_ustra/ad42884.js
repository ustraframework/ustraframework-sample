(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{1768:function(e,t,n){"use strict";var o=N(n(0)),d=N(n(27)),r=n(20),l=N(n(14)),c=N(n(103)),f=N(n(2)),h=n(10),w=n(1),m=N(n(76)),_=N(n(58)),v=N(n(647)),C=N(n(68)),E=n(71),x=n(21),I=N(n(1769)),y=N(n(30)),R=N(n(80)),D=N(n(138)),k=N(n(56)),T=N(n(29)),V=N(n(434)),B=N(n(291)),F=n(19),O=N(F),P=N(n(6)),A=N(n(288)),S=N(n(185));function N(e){return e&&e.__esModule?e:{default:e}}function U(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var M="edit-form",G="edit-form-item",H="readonly",K="dx-editor-cell",W="dx-selection",$="dx-edit-row",L="dx-command-edit",z="dx-command-edit-with-icons",J="__DX_INSERT_INDEX__",X="dx-cell-modified",Y="dx-cell-focus-disabled",Q="input:not([type='hidden'])",Z="[tabindex], "+Q,ee="batch",te="row",ie="cell",ne="form",ae="popup",oe="insert",de="update",re="remove",le="click",se=[ee,te,ie,ne,ae],ue=[te,ne,ae],ce=[ee,ie],fe=[ne,ae],pe=[te,ne],he={save:"dx-link-save",cancel:"dx-link-cancel",edit:"dx-link-edit",undelete:"dx-link-undelete",delete:"dx-link-delete",add:"dx-link-add"},ge={save:"save",cancel:"revert",edit:"edit",undelete:"revert",delete:"trash",add:"add"},we={edit:"editRow",delete:"deleteRow",undelete:"undeleteRow",save:"saveEditData",cancel:"cancelEditData",add:"addRowByRowIndex"},me={add:"allowAdding",edit:"allowUpdating",delete:"allowDeleting"},_e=["edit","save","cancel","delete","undelete"],ve="editing.popup",Ce=function(e){return function(t){var n=t instanceof Error?t:new Error(t&&String(t)||"Unknown error");e.reject(n)}},Ee=function(e){var t=e.option("editing.mode");return-1!==se.indexOf(t)?t:te},xe=function(e){var t=Ee(e);return-1!==ue.indexOf(t)},Ie=function(e,t){return t.isEditing||e&&t.column.allowEditing},ye=function(e,t){var n=!!t.column.command,o=Ie(e,t),d=!n&&(o||t.column.showEditorAlways);return"data"===t.rowType&&d},Re=m.default.ViewController.inherit(function(){var e=function(e){return function(t,n){var d=(0,o.default)("<div>").appendTo(t);e.getController("editorFactory").createEditor(d,(0,w.extend)({},n.column,{value:n.value,setValue:n.setValue,row:n.row,parentType:"dataRow",width:null,readOnly:!n.setValue,isOnForm:n.isOnForm,id:n.id}))}},t=function(e,t){var o=-1;return e.some((function(button,e){if(n(button)===t)return o=e,!0})),o};function n(button){return f.default.isObject(button)?button.name:button}var m=function e(t,n){t.forEach((function(t){t.items||t.tabs?e(t.items||t.tabs,n):n(t)}))};return{init:function(){var e,t,n=this;(n._editRowIndex=-1,n._editData=[],n._editColumnIndex=-1,n._columnsController=n.getController("columns"),n._dataController=n.getController("data"),n._rowsView=n.getView("rowsView"),n._editForm=null,n._updateEditFormDeferred=null,n._lastOperation=null,n._deferreds&&n._deferreds.forEach((function(e){return e.reject("cancel")})),n._deferreds=[],n._dataChangedHandler||(n._dataChangedHandler=n._handleDataChanged.bind(n),n._dataController.changed.add(n._dataChangedHandler)),n._saveEditorHandler)||(n.createAction("onInitNewRow",{excludeValidators:["disabled","readOnly"]}),n.createAction("onRowInserting",{excludeValidators:["disabled","readOnly"]}),n.createAction("onRowInserted",{excludeValidators:["disabled","readOnly"]}),n.createAction("onEditingStart",{excludeValidators:["disabled","readOnly"]}),n.createAction("onRowUpdating",{excludeValidators:["disabled","readOnly"]}),n.createAction("onRowUpdated",{excludeValidators:["disabled","readOnly"]}),n.createAction("onRowRemoving",{excludeValidators:["disabled","readOnly"]}),n.createAction("onRowRemoved",{excludeValidators:["disabled","readOnly"]}),n._pointerUpEditorHandler=function(){var e;t=null===(e=n.getController("columnsResizer"))||void 0===e?void 0:e.isResizing()},n._pointerDownEditorHandler=function(t){return e=(0,o.default)(t.target)},n._saveEditorHandler=n.createAction((function(d){var l=d.event,c=(0,o.default)(l.target),f=l.targetComponent;if((!e||!e.is("input")||e.is(c))&&!xe(n)&&!n._editCellInProgress){var h=E(c)||E(null==f?void 0:f.$element()),w=!!c.closest((0,r.getWindow)().document).length,m=f&&!f._disposed&&f!==n.component,_=!!c.closest(".".concat(n.addWidgetPrefix("addrow-button"))).length,v=c.hasClass(n.addWidgetPrefix("focus-overlay")),C=Ee(n)===ie;t||h||v||_&&C&&n.isEditing()||!w&&!m||n._closeEditItem.bind(n)(c)}function E(e){return e&&!!e.closest(".".concat("dx-dropdowneditor-overlay")).length}})),l.default.on(d.default.getDocument(),C.default.up,n._pointerUpEditorHandler),l.default.on(d.default.getDocument(),C.default.down,n._pointerDownEditorHandler),l.default.on(d.default.getDocument(),_.default.name,n._saveEditorHandler));n._updateEditColumn(),n._updateEditButtons()},getUpdatedData:function(data){var e=this._dataController.keyOf(data),t=this._editData,n=(0,E.getIndexByKey)(e,t);return t[n]?(0,E.createObjectWithChanges)(data,t[n].data):data},getInsertedData:function(){return this._editData.filter((function(e){return e.data&&e.type===oe})).map((function(e){return e.data}))},getRemovedData:function(){return this._editData.filter((function(e){return e.oldData&&e.type===re})).map((function(e){return e.oldData}))},_fireDataErrorOccurred:function(e){if("cancel"!==e){var t=this.getPopupContent();this._dataController.dataErrorOccurred.fire(e,t)}},_needToCloseEditableCell:function(e){var t=this.component.$element(),n=this.isEditing();if((!t||!!e.closest(t).length)&&e.closest(".dx-data-row").length){var o=this.getView("rowsView"),d=e.closest(".dx-row> td"),r=o.getRowIndex(d.parent()),l=o.getCellElements(r).index(d),c=this._columnsController.getVisibleColumns(),f=c[l]&&c[l].allowEditing;n=n&&!f&&!this.isEditCell(r,l)}return n},_closeEditItem:function(e){this._needToCloseEditableCell(e)&&this.closeEditCell()},_handleDataChanged:function(e){var t=this,n=t._editForm;"standard"===t.option("scrolling.mode")&&t.resetRowAndPageIndices(),"prepend"===e.changeType&&(0,h.each)(t._editData,(function(t,n){n.rowIndex+=e.items.length})),"refresh"===e.changeType&&Ee(t)===ae&&n&&n.option("visible")&&this._repaintEditPopup()},_isDefaultButtonVisible:function(button,e){var t=!0,n=xe(this),o=e.row&&e.row.rowIndex===this._getVisibleEditRowIndex()&&n;switch(button.name){case"edit":t=!o&&this.allowUpdating(e)&&n;break;case"save":case"cancel":t=o;break;case"delete":t=!o&&this.allowDeleting(e)&&!e.row.removed;break;case"undelete":t=this.allowDeleting(e)&&e.row.removed}return t},_isButtonVisible:function(button,e){var t=button.visible;return f.default.isDefined(t)?f.default.isFunction(t)?t.call(button,{component:e.component,row:e.row,column:e.column}):t:this._isDefaultButtonVisible(button,e)},_getButtonConfig:function(button,e){var t=this,o=f.default.isObject(button)?button:{},d=n(button),r=function(e){var t=e.component.option("editing.texts")||{};return{save:t.saveRowChanges,cancel:t.cancelRowChanges,edit:t.editRow,undelete:t.undeleteRow,delete:t.deleteRow,add:t.addRowToNode}}(e),l=we[d],c=this.option("editing"),h=me[d],m=!h||c[h];return(0,w.extend)({name:d,text:r[d],cssClass:he[d],onClick:function(n){var o=n.event;o.stopPropagation(),o.preventDefault(),setTimeout((function(){e.row&&m&&t[l]&&t[l](e.row.rowIndex)}))}},o)},_getEditingButtons:function(e){var n,o=this,d=!!e.column.buttons,r=(e.column.buttons||[]).slice();return d?((n=t(r,"edit"))>=0&&(t(r,"save")<0&&r.splice(n+1,0,"save"),t(r,"cancel")<0&&r.splice(t(r,"save")+1,0,"cancel")),(n=t(r,"delete"))>=0&&t(r,"undelete")<0&&r.splice(n+1,0,"undelete")):r=_e.slice(),r.map((function(button){return o._getButtonConfig(button,e)}))},_renderEditingButtons:function(e,t,n){var o=this;t.forEach((function(button){o._isButtonVisible(button,n)&&o._createButton(e,button,n)}))},_getEditCommandCellTemplate:function(){var e=this;return function(t,n){var d=(0,o.default)(t);if("data"===n.rowType){var r=e._getEditingButtons(n);e._renderEditingButtons(d,r,n),n.watch&&n.watch((function(){return r.map((function(button){return e._isButtonVisible(button,n)}))}),(function(){d.empty(),e._renderEditingButtons(d,r,n)}))}else(0,E.setEmptyText)(d)}},correctEditRowIndexAfterExpand:function(e){this._editRowIndex>this._dataController.getRowIndexByKey(e)&&this._editRowIndex++},correctEditRowIndex:function(e){this._editRowIndex+=e(this._getVisibleEditRowIndex())},isRowEditMode:function(){return xe(this)},isFormEditMode:function(){var e=Ee(this);return-1!==fe.indexOf(e)},isCellOrBatchEditMode:function(){var e=this.getEditMode();return e===ee||e===ie},getEditMode:function(){return Ee(this)},getFirstEditableColumnIndex:function(){var e,t=this.getController("columns"),n=this._firstFormItem;if(Ee(this)===ne&&n){var o=this._rowsView.getCellElements(this._editRowIndex);e=this._rowsView._getEditFormEditorVisibleIndex(o,n.column)}else{var d=t.getVisibleColumns();(0,h.each)(d,(function(t,n){if(n.allowEditing)return e=t,!1}))}return e},getFirstEditableCellInRow:function(e){var t=this.getView("rowsView");return t&&t._getCellElement(e||0,this.getFirstEditableColumnIndex())},getFocusedCellInRow:function(e){return this.getFirstEditableCellInRow(e)},getIndexByKey:function(e,t){return(0,E.getIndexByKey)(e,t)},hasChanges:function(e){for(var t=this,n=!1,i=0;i<t._editData.length;i++)if(t._editData[i].type&&(!f.default.isDefined(e)||t._dataController.getRowIndexByKey(t._editData[i].key)===e)){n=!0;break}return n},dispose:function(){this.callBase(),clearTimeout(this._inputFocusTimeoutID),l.default.off(d.default.getDocument(),C.default.up,this._pointerUpEditorHandler),l.default.off(d.default.getDocument(),C.default.down,this._pointerDownEditorHandler),l.default.off(d.default.getDocument(),_.default.name,this._saveEditorHandler)},optionChanged:function(e){if("editing"===e.name){var t=e.fullName,n=this._editPopup;if(t&&0===t.indexOf(ve)){if(n){var o=t.slice(ve.length+1);o?n.option(o,e.value):n.option(e.value)}}else n&&n.option("visible")&&0===t.indexOf("editing.form")?this._repaintEditPopup():this.init();e.handled=!0}else this.callBase(e)},publicMethods:function(){return["insertRow","addRow","removeRow","deleteRow","undeleteRow","editRow","editCell","closeEditCell","saveEditData","cancelEditData","hasEditData"]},refresh:function(e){var t=Ee(this),n=t===ee||e&&"virtual"!==this.option("scrolling.mode");t!==ee&&t!==ie?this.init():n&&(this._editRowIndex=-1,this._editColumnIndex=-1)},isEditing:function(){return this._editRowIndex>-1},isEditRow:function(e){var t=Ee(this);return this._getVisibleEditRowIndex()===e&&-1!==ue.indexOf(t)},getEditRowKey:function(){var e=this._dataController.items()[this._getVisibleEditRowIndex()];return e&&e.key},getEditRowIndex:function(){return this._getVisibleEditRowIndex()},getEditFormRowIndex:function(){var e=Ee(this);return e===ne||e===ae?this._getVisibleEditRowIndex():-1},isEditCell:function(e,t){return!(!Array.isArray(this._editData)||!this._editData.length)&&this._getVisibleEditRowIndex()===e&&this._editColumnIndex===t},getPopupContent:function(){var e=Ee(this),t=this._editPopup&&this._editPopup.option("visible");if(e===ae&&t)return this._$popupContent},getEditForm:function(){return this._editForm},_needInsertItem:function(e,t){var n=this._dataController.dataSource(),o=this.option("scrolling.mode"),d=n.pageIndex(),r=n.beginPageIndex?n.beginPageIndex():d,l=n.endPageIndex?n.endPageIndex():d;if("standard"!==o)switch(t){case"append":return e.key.pageIndex===l;case"prepend":return e.key.pageIndex===r;case"refresh":e.key.rowIndex=0,e.key.dataRowIndex=0,e.key.pageIndex=0;break;default:return e.key.pageIndex>=r&&e.key.pageIndex<=l}return e.key.pageIndex===d},_generateNewItem:function(e){var t={key:e};return e&&e[J]&&(t[J]=e[J]),t},_getLoadedRowIndexByInsertKey:function(e,t,n){var o=this._dataController,d=o.getRowIndexOffset(!0),r=n.dataRowIndex-d;"append"===t.changeType&&(r-=o.items(!0).length,t.removeCount&&(r+=t.removeCount));for(var i=0;i<r;i++)e[i]&&e[i][J]&&r++;return r},processItems:function(e,t){var n=t.changeType;this.update(n);for(var o=this._editData,i=0;i<o.length;i++){var d=o[i].key;if(d&&o[i].type===oe){var r=this._getLoadedRowIndexByInsertKey(e,t,d),l=this._generateNewItem(d);r>=0&&this._needInsertItem(o[i],n,e,l)&&e.splice(d.dataRowIndex?r:0,0,l)}}return e},processDataItem:function(e,t,n){var data,o=this,d=t.visibleColumns,r=e.data[J]?e.data.key:e.key,l=(0,E.getIndexByKey)(r,o._editData);if(e.isEditing=!1,l>=0){var c=Ee(o),f=o._editData[l];switch(data=f.data,f.type){case oe:c===ae&&(e.visible=!1),e.isNewRow=!0,e.key=r,e.data=data;break;case de:e.modified=!0,e.oldData=e.data,e.data=(0,E.createObjectWithChanges)(e.data,data),e.modifiedValues=n(data,d,!0);break;case re:c===ee&&(e.data=(0,E.createObjectWithChanges)(e.data,data)),e.removed=!0}}},insertRow:function(){return k.default.log("W0002","dxDataGrid","insertRow","15.2","Use the 'addRow' method instead"),this.addRow()},_initNewRow:function(e){var t=this;if(this.executeAction("onInitNewRow",e),e.promise){var n=new F.Deferred;return(0,F.when)((0,F.fromPromise)(e.promise)).done(n.resolve).fail(Ce(n)).fail((function(e){return t._fireDataErrorOccurred(e)})),n}},_getInsertKey:function(e){var t=this,n=t._dataController,o=n.items(),d=Ee(t),r={parentKey:e,pageIndex:n.pageIndex(),rowIndex:t._getInsertRowIndex(e)},l=o[r.rowIndex];return l&&(!l.isEditing&&"detail"===l.rowType||"detailAdaptive"===l.rowType)&&r.rowIndex++,r.dataRowIndex=n.getRowIndexOffset()+o.filter((function(e,t){return t<r.rowIndex&&("data"===e.rowType&&!e.isNewRow||"group"===e.rowType)})).length,d!==ee&&(t._editRowIndex=r.rowIndex+t._dataController.getRowIndexOffset()),r[J]=t._getInsertIndex(),r},_getInsertRowIndex:function(e){var t=this.getView("rowsView"),n=this._dataController.getRowIndexByKey(e);return n>=0?n+1:t?t.getTopVisibleItemIndex(!0):0},_getInsertIndex:function(){var e=0;return this._editData.forEach((function(t){t.type===oe&&t.key[J]>e&&(e=t.key[J])})),e+1},addRow:function(e){var t=this,n=t._dataController,o=n.store(),d=o&&o.key(),param={data:{}},r=Ee(t),l=t._getVisibleEditRowIndex(),f=new F.Deferred;return o?r===ie&&t.hasChanges()?(t.saveEditData().done((function(){t.hasChanges()?f.reject("cancel"):t.addRow(e).done(f.resolve).fail(f.reject)})),f.promise()):(t.refresh(),t._allowRowAdding()?(d||(param.data.__KEY__=String(new c.default)),(0,F.when)(t._initNewRow(param,e)).done((function(){t._allowRowAdding()?(t._addRowCore(param.data,e,l),f.resolve()):f.reject("cancel")})).fail(f.reject),f.promise()):f.reject("cancel")):(n.fireError("E1052",this.component.NAME),f.reject())},_allowRowAdding:function(){var e=Ee(this),t=this._getInsertIndex();return!(e!==ee&&t>1)},_addRowCore:function(data,e,t){var n=this,o=n._getVisibleEditRowIndex(),d=n._getInsertKey(e),r=Ee(n);n._addEditData({key:d,data:data,type:oe}),n._dataController.updateItems({changeType:"update",rowIndices:[t,o,d.rowIndex]}),r===ae?n._showEditPopup(d.rowIndex):n._focusFirstEditableCellInRow(d.rowIndex),n._afterInsertRow({key:d,data:data})},_focusFirstEditableCellInRow:function(e){var t=this,n=t.getFirstEditableCellInRow(e);t._editCellInProgress=!0,t._delayedInputFocus(n,(function(){t._editCellInProgress=!1;var n=t.getFirstEditableCellInRow(e),o="dblClick"===t.option("editing.startEditAction")?v.default.name:_.default.name;n&&l.default.trigger(n,o)}))},_isEditingStart:function(e){return this.executeAction("onEditingStart",e),e.cancel},_beforeEditCell:function(e,t,n){var o=this;if(Ee(o)===ie&&!n.isNewRow&&o.hasChanges()){var d=new F.Deferred;return o.saveEditData().always((function(){d.resolve(o.hasChanges())})),d}},_beforeUpdateItems:function(){},_getVisibleEditRowIndex:function(){return this._editRowIndex>=0?this._editRowIndex-this._dataController.getRowIndexOffset():-1},editRow:function(e){var t,n=this,o=n._dataController,d=o.items(),r=d[e],l={data:r&&r.data,cancel:!1},c=n._getVisibleEditRowIndex();if(r){if(e===c)return!0;if(r.isNewRow||(l.key=r.key),!n._isEditingStart(l)){n.init(),n._pageIndex=o.pageIndex(),n._editRowIndex=(d[0].isNewRow?e-1:e)+n._dataController.getRowIndexOffset(),n._addEditData({data:{},key:r.key,oldData:r.data});var f=[c,e],h=Ee(n);n._beforeUpdateItems(f,e,c),h===ae?n._showEditPopup(e):o.updateItems({changeType:"update",rowIndices:f}),-1!==pe.indexOf(h)&&(t=n.getFocusedCellInRow(n._getVisibleEditRowIndex()),n._delayedInputFocus(t,(function(){t&&n.component.focus(t)})))}}},_showEditPopup:function(e,t){var n=this,d="desktop"!==T.default.current().deviceType,r=(0,w.extend)({showTitle:!1,fullScreen:d,toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:n._getSaveButtonConfig()},{toolbar:"bottom",location:"after",widget:"dxButton",options:n._getCancelButtonConfig()}],contentTemplate:n._getPopupEditFormTemplate(e)},n.option(ve));if(!n._editPopup){var c=(0,o.default)("<div>").appendTo(n.component.$element()).addClass(n.addWidgetPrefix("edit-popup"));n._editPopup=n._createComponent(c,D.default,{}),n._editPopup.on("hiding",n._getEditPopupHiddenHandler()),n._editPopup.on("shown",(function(e){l.default.trigger(e.component.$content().find(Z).not(".dx-scrollable-container").first(),"focus"),t&&n._editForm&&n._editForm.repaint()}))}n._editPopup.option(r),n._editPopup.show()},_repaintEditPopup:function(){var e=this._getVisibleEditRowIndex();if(this._editPopup&&this._editPopup.option("visible")&&e>=0){var t=this._editPopup.option("animation");this._editPopup.option("animation",null),this._showEditPopup(e,!0),this._editPopup.option("animation",t)}},_getEditPopupHiddenHandler:function(){var e=this;return function(t){e.isEditing()&&e.cancelEditData()}},_getPopupEditFormTemplate:function(e){var t=this,n=t.component.getVisibleRows()[e],d={row:n,rowType:n.rowType,key:n.key};return function(e){var n=t.getEditFormTemplate(),r=t._createComponent((0,o.default)("<div>").appendTo(e),S.default);t._$popupContent=r.$content(),n(t._$popupContent,d,!0)}},_getSaveButtonConfig:function(){return{text:this.option("editing.texts.saveRowChanges"),onClick:this.saveEditData.bind(this)}},_getCancelButtonConfig:function(){return{text:this.option("editing.texts.cancelRowChanges"),onClick:this.cancelEditData.bind(this)}},_removeEditDataItem:function(e){e>=0&&this._editData.splice(e,1)},executeOperation:function(e,t){var n=this;this._lastOperation&&this._lastOperation.reject(),this._lastOperation=e,this.waitForDeferredOperations().done((function(){"rejected"!==e.state()&&(t(),n._lastOperation=null)})).fail((function(){e.reject(),n._lastOperation=null}))},waitForDeferredOperations:function(){return F.when.apply(void 0,U(this._deferreds))},editCell:function(e,t){var n,o=this,d=new F.Deferred;return this.executeOperation(d,(function(){n=o._editCellCore(e,t),(0,F.when)(n).done(d.resolve).fail(d.reject)})),void 0!==n?n:d.promise()},_editCellCore:function(e,t){var n=this,o=n._columnsController,d=n._dataController,r=d.items()[e],l={data:r&&r.data,cancel:!1},c=n._getVisibleEditRowIndex(),h=o.getVisibleColumns(),w=h[n._editColumnIndex];f.default.isString(t)&&(t=o.columnOption(t,"index"),t=o.getVisibleIndex(t));var m=l.column=h[t];if(m&&r&&("data"===r.rowType||"detailAdaptive"===r.rowType)&&!r.removed&&!xe(n)){if(n.isEditCell(e,t))return!0;var _=e+d.getRowIndexOffset();return(0,F.when)(n._beforeEditCell(e,t,r)).done((function(e){e||(n._prepareEditCell(l,r,t,_)?P.default.deferRender((function(){n._repaintEditCell(m,w,c)})):n._processCanceledEditingCell())}))}return!1},_processCanceledEditingCell:function(){},_prepareEditCell:function(e,t,n,o){var d=this;return t.isNewRow||(e.key=t.key),!d._isEditingStart(e)&&(d._editRowIndex=o,d._editColumnIndex=n,d._pageIndex=d._dataController.pageIndex(),d._addEditData({data:{},key:t.key,oldData:t.data}),!0)},_repaintEditCell:function(e,t,n){var o=this,d=o._rowsView;e&&e.showEditorAlways&&(!t||t.showEditorAlways)||(o._editCellInProgress=!0,o.getController("editorFactory").loseFocus(),o._dataController.updateItems({changeType:"update",rowIndices:[n,o._getVisibleEditRowIndex()]}));var r=d&&d._getCellElement(o._getVisibleEditRowIndex(),o._editColumnIndex);r&&!r.find(":focus").length?o._focusEditingCell((function(){o._editCellInProgress=!1}),r,!0):o._editCellInProgress=!1},_delayedInputFocus:function(e,t,n){var o=this;function d(){if(t&&t(),e){var n=e.find(Z).first();(0,E.focusAndSelectElement)(o,n)}o._beforeFocusCallback=null}T.default.real().ios||T.default.real().android?d():(o._beforeFocusCallback&&o._beforeFocusCallback(),clearTimeout(o._inputFocusTimeoutID),n&&(o._beforeFocusCallback=t),o._inputFocusTimeoutID=setTimeout(d))},_focusEditingCell:function(e,t,n){var o=this,d=o.getView("rowsView");t=t||d&&d._getCellElement(o._getVisibleEditRowIndex(),o._editColumnIndex),o._delayedInputFocus(t,e,n)},removeRow:function(e){return k.default.log("W0002","dxDataGrid","removeRow","15.2","Use the 'deleteRow' method instead"),this.deleteRow(e)},deleteRow:function(e){var t=this;if("cell"===this.option("editing.mode")&&this.isEditing()){var n=this._dataController.items()[e].isNewRow;this.closeEditCell(null,n).always((function(){t._checkAndDeleteRow(e)}))}else this._checkAndDeleteRow(e)},_checkAndDeleteRow:function(e){var t=this,n=t.option("editing"),o=n&&n.texts,d=n&&n.mode===ee,r=n&&n.confirmDelete,l=o&&o.confirmDeleteMessage,c=t._dataController.items()[e],h=d||!t.isEditing()||c.isNewRow;if(c&&h)if(!d&&r&&l){var w=o&&o.confirmDeleteTitle,m=f.default.isDefined(w)&&w.length>0;I.default.confirm(l,w,m).done((function(n){n&&t._deleteRowCore(e)}))}else t._deleteRowCore(e)},_deleteRowCore:function(e){var t=this._dataController,n=t.items()[e],o=n&&n.key,d=this._getVisibleEditRowIndex(),r=this.option("editing.mode")===ee;this.refresh();var l=(0,E.getIndexByKey)(o,this._editData);return l>=0?this._editData[l].type===oe?this._removeEditDataItem(l):this._addEditData({key:o,type:re}):this._addEditData({key:o,oldData:n.data,type:re}),r?(t.updateItems({changeType:"update",rowIndices:[d,e]}),(new F.Deferred).resolve()):this.saveEditData()},undeleteRow:function(e){var t=this,n=t._dataController,o=n.items()[e],d=t._getVisibleEditRowIndex(),r=o&&o.key;if(o){var l=(0,E.getIndexByKey)(r,t._editData);if(l>=0){var c=t._editData[l];f.default.isEmptyObject(c.data)?t._removeEditDataItem(l):t._addEditData({key:r,type:de}),n.updateItems({changeType:"update",rowIndices:[d,e]})}}},_saveEditDataCore:function(e,t,n){var o=this,d=o._dataController.store(),r=!0;function l(e,t,n){var d=new F.Deferred;return o.executeAction(e,t),(0,F.when)((0,F.fromPromise)(t.cancel)).done((function(e){e?setTimeout((function(){d.resolve("cancel")})):n(t).done(d.resolve).fail(Ce(d))})).fail(Ce(d)),d}return(0,h.each)(o._editData,(function(c,h){var w,m,data=h.data,_=h.oldData,v=h.type;if(!o._beforeSaveEditData(h,c)){switch(v){case re:w=l("onRowRemoving",m={data:_,key:h.key,cancel:!1},(function(){return d.remove(h.key).done((function(e){n.push({type:"remove",key:e})}))}));break;case oe:w=l("onRowInserting",m={data:data,cancel:!1},(function(){return d.insert(m.data).done((function(data,e){f.default.isDefined(e)&&(h.key=e),data&&f.default.isObject(data)&&data!==m.data&&(h.data=data),n.push({type:"insert",data:data,index:0})}))}));break;case de:w=l("onRowUpdating",m={newData:data,oldData:_,key:h.key,cancel:!1},(function(){return d.update(h.key,m.newData).done((function(data,e){data&&f.default.isObject(data)&&data!==m.newData&&(h.data=data),n.push({type:"update",key:e,data:data})}))}))}if(w){var C=new F.Deferred;w.always((function(data){r="cancel"!==data,t.push({key:h.key,result:data})})).always(C.resolve),e.push(C.promise())}}})),r},_processSaveEditDataResult:function(e){for(var t=this,n=!1,o=Ee(t),i=0;i<e.length;i++){var d=e[i].result,r="cancel"===d,l=(0,E.getIndexByKey)(e[i].key,t._editData),c=t._editData[l];if(d&&d instanceof Error){if(c&&(c.error=d),t._fireDataErrorOccurred(d),o!==ee){c&&c.type===re&&t._removeEditDataItem(l);break}}else r&&c&&(o===ee||c.type!==re)||(t._removeEditDataItem(l),n=!r)}return n},_fireSaveEditDataEvents:function(e){var t=this;(0,h.each)(e,(function(e,n){var data=n.data,o=n.key,d=n.type,r={key:o,data:data};switch(n.error&&(r.error=n.error),d){case re:t.executeAction("onRowRemoved",(0,w.extend)({},r,{data:n.oldData}));break;case oe:t.executeAction("onRowInserted",r);break;case de:t.executeAction("onRowUpdated",r)}}))},saveEditData:function(){var e=this,t=new F.Deferred,n=function(n){(0,F.when)(e._afterSaveEditData(n)).done((function(){t.resolve()}))};return this.waitForDeferredOperations().done((function(){e._saving?n():(0,F.when)(e._beforeSaveEditData()).done((function(o){o?n(o):e._saveEditDataInner().done(t.resolve).fail(t.reject)})).fail(t.reject)})).fail(t.reject),t.promise()},_saveEditDataInner:function(){var e=this,t=[],n=[],d=[],r=this._dataController,l=r.dataSource(),c=Ee(this),f=new F.Deferred,h=this._editData.slice(0),w=function(){c!==ie&&(e._editColumnIndex=-1,e._editRowIndex=-1)},m=function(t){(0,F.when)(e._afterSaveEditData()).done((function(){f.resolve(t)}))};return this._saveEditDataCore(n,t,d)||c!==ie||this._focusEditingCell(),n.length?(this._saving=!0,l&&l.beginLoading(),F.when.apply(o.default,n).done((function(){if(e._processSaveEditDataResult(t)){!function(){if(c===ee){var t=e._columnsController.getVisibleColumns().length;h.forEach((function(n){var o=n.key,d=e._dataController.getRowIndexByKey(o);if(-1!==d)for(var r=0;r<t;r++)e._rowsView._getCellElement(d,r).removeClass(X)}))}}(),w(),c===ae&&e._editPopup&&e._editPopup.hide(),l&&l.endLoading();var n=e.option("editing.refreshMode"),o="reshape"!==n&&"repaint"!==n;o||r.push(d),(0,F.when)(r.refresh({selection:o,reload:o,load:"reshape"===n,changesOnly:e.option("repaintChangesOnly")})).always((function(){e._fireSaveEditDataEvents(h)})).done((function(){m()})).fail((function(e){m(e)}))}else l&&l.endLoading(),f.resolve()})).fail((function(e){l&&l.endLoading(),f.resolve(e)})),f.always((function(){e._focusEditingCell(),e._saving=!1})).promise()):(xe(this)?this.hasChanges()||this.cancelEditData():-1!==ce.indexOf(c)?(w(),r.updateItems()):this._focusEditingCell(),m(),f.promise())},isSaving:function(){return this._saving},_updateEditColumn:function(){var e=this,t=e._isEditColumnVisible(),n=e.option("editing.useIcons"),o=L+(n?" dx-command-edit-with-icons":"");e._columnsController.addCommandColumn({type:"buttons",command:"edit",visible:t,cssClass:o,width:"auto",alignment:"center",cellTemplate:e._getEditCommandCellTemplate(),fixedPosition:"right"}),e._columnsController.columnOption("command:edit",{visible:t,cssClass:o})},_isEditColumnVisible:function(){var e=this.option("editing");if(e){var t=!1;switch(Ee(this)){case te:t=e.allowUpdating||e.allowAdding;break;case ne:case ae:t=e.allowUpdating}return e.allowDeleting||t}},_updateEditButtons:function(){var e=this.getView("headerPanel"),t=this.hasChanges();e&&(e.setToolbarItemDisabled("saveButton",!t),e.setToolbarItemDisabled("revertButton",!t))},_applyModified:function(e){e&&e.addClass(X)},_beforeCloseEditCellInBatchMode:function(){},cancelEditData:function(){var e=this,t=Ee(e),n=this._getVisibleEditRowIndex(),o=e._dataController;e._beforeCancelEditData(),e.init(),-1!==ue.indexOf(t)&&n>=0?o.updateItems({changeType:"update",rowIndices:[n,n+1]}):o.updateItems({repaintChangesOnly:e.option("repaintChangesOnly")}),t===ae&&e._hideEditPopup()},_hideEditPopup:function(){this._editPopup&&this._editPopup.option("visible",!1)},hasEditData:function(){return this.hasChanges()},closeEditCell:function(e,t){var n=this,o=O.default.when(),d=this._getVisibleEditRowIndex();return xe(this)||(o=O.default.Deferred(),this.executeOperation(o,(function(){n._closeEditCellCore(e,d,t),o.resolve()}))),o.promise()},_closeEditCellCore:function(e,t,n){var o=this,d=Ee(o),r=o._dataController;if(d===ie&&o.hasChanges())n||o.saveEditData().done((function(e){o.hasChanges()||o.closeEditCell(!!e)}));else if(t>=0){var l=[t];o._editRowIndex=-1,o._editColumnIndex=-1,o._beforeCloseEditCellInBatchMode(l),e||r.updateItems({changeType:"update",rowIndices:l})}},update:function(e){var t=this,n=t._dataController;n&&t._pageIndex!==n.pageIndex()&&("refresh"===e&&t.refresh(!0),t._pageIndex=n.pageIndex()),t._updateEditButtons()},_getRowIndicesForCascadeUpdating:function(e,t){return t?[]:[e.rowIndex]},addDeferred:function(e){var t=this;this._deferreds.indexOf(e)<0&&(this._deferreds.push(e),e.always((function(){var n=t._deferreds.indexOf(e);n>=0&&t._deferreds.splice(n,1)})))},_prepareEditDataParams:function(e,t,text){var n,d=this,r={},l=null===(n=e.row)||void 0===n?void 0:n.data,c=e.key,h=(0,o.default)(e.cellElement),m=Ee(d),_=new F.Deferred;void 0!==c&&(m===ee&&d._applyModified(h,e),e.value=t,(0,F.fromPromise)(e.column.setCellValue(r,t,(0,w.extend)(!0,{},l),text)).done((function(){_.resolve({data:r,key:c,oldData:l,type:de})})).fail(Ce(_)).fail((function(e){return d._fireDataErrorOccurred(e)})),f.default.isDefined(text)&&e.column.displayValueMap&&(e.column.displayValueMap[t]=text),e.values&&(e.values[e.columnIndex]=t),d.addDeferred(_));return _},updateFieldValue:function(e,t,text,n){var o=this,d=e.key,r=new F.Deferred;return void 0===d&&this._dataController.fireError("E1043"),e.column.setCellValue?this._prepareEditDataParams(e,t,text).done((function(t){(0,F.when)(o._applyEditDataParams(e,t,n)).always((function(){r.resolve()}))})):r.resolve(),r.promise()},_focusPreviousEditingCellIfNeed:function(e){var t=this;if(t.hasEditData()&&!t.isEditCell(e.rowIndex,e.columnIndex))return t._focusEditingCell(),t._updateEditRow(e.row,!0),!0},_needUpdateRow:function(e){var t=this._columnsController.getVisibleColumns();e||(e=t[this._editColumnIndex]);var n=e&&e.setCellValue!==e.defaultSetCellValue,o=t.some((function(e){return e.calculateCellValue!==e.defaultCalculateCellValue}));return n||o},_applyEditDataParams:function(e,t,n){var o=this,d=Ee(o),r=e.column.setCellValue!==e.column.defaultSetCellValue,l=e.column.showEditorAlways,c=d===ie&&e.row&&!e.row.isNewRow;if(l&&!n&&c&&o.hasEditData()&&!o.isEditCell(e.rowIndex,e.columnIndex))return o._focusEditingCell(),void o._updateEditRow(e.row,!0,r);if(o._addEditData(t,e.row),o._updateEditButtons(),l&&!n){if(c)return o._editRowIndex=e.row.rowIndex+o._dataController.getRowIndexOffset(),o._editColumnIndex=e.columnIndex,o.saveEditData();d===ee&&(n=o._needUpdateRow(e.column))}var f=e.row;f&&(n||r?o._updateEditRow(f,n,r):f.update&&f.update())},_updateEditRowCore:function(e,t,n){var o=this,d=o._editForm;Ee(o)===ae?o.option("repaintChangesOnly")?e.update&&e.update(e):d&&(o._updateEditFormDeferred=(new F.Deferred).done((function(){return d.repaint()})),o._updateLockCount||o._updateEditFormDeferred.resolve()):o._dataController.updateItems({changeType:"update",rowIndices:o._getRowIndicesForCascadeUpdating(e,t)}),n&&o._editForm&&!e.isNewRow&&o._editForm.validate()},_endUpdateCore:function(){this._updateEditFormDeferred&&this._updateEditFormDeferred.resolve()},_updateEditRow:function(e,t,n){var r=this;if(t||!xe(r))r._updateEditRowCore(e,!t,n),t||r._focusEditingCell();else{var l=new F.Deferred;r.addDeferred(l),setTimeout((function(){var t=(0,o.default)(d.default.getActiveElement()),c=r._rowsView.getCellIndex(t,e.rowIndex),f=t.get(0),h=(0,E.getSelectionRange)(f);if(r._updateEditRowCore(e,!1,n),c>=0){var w=r._rowsView._getCellElement(e.rowIndex,c);r._delayedInputFocus(w,(function(){setTimeout((function(){f=d.default.getActiveElement(),h.selectionStart>=0&&(0,E.setSelectionRange)(f,h)}))}))}l.resolve()}))}},_addEditData:function(e,t){var n=this,o=(0,E.getIndexByKey)(e.key,n._editData);return o<0&&(o=n._editData.length,n._editData.push(e)),n._editData[o]&&(e.data&&(n._editData[o].data=(0,E.createObjectWithChanges)(n._editData[o].data,e.data)),n._editData[o].type&&e.data||!e.type||(n._editData[o].type=e.type),t&&(t.oldData=n._editData[o].oldData,t.data=(0,E.createObjectWithChanges)(t.data,e.data))),o},_getFormEditItemTemplate:function(t,n){return n.editCellTemplate||e(this)},renderFormEditTemplate:function(e,t,form,n,d){var l=this,c=(0,o.default)(n),f=t.column,h=function(e){var t=e.column;return e.isCustomEditorType?e.editorType:t.formItem&&t.formItem.editorType}(t),m=null==e?void 0:e.row.data,_=(0,w.extend)({},e,{data:m,cellElement:null,isOnForm:!0,item:t,column:(0,w.extend)({},f,{editorType:h,editorOptions:t.editorOptions}),id:form.getItemID(t.name||t.dataField),columnIndex:f.index,setValue:!d&&f.allowEditing&&function(e){l.updateFieldValue(_,e)}});_.value=f.calculateCellValue(m);var template=l._getFormEditItemTemplate.bind(l)(_,f);return l._rowsView.renderTemplate(c,template,_,!!c.closest((0,r.getWindow)().document).length).done((function(){l._rowsView._updateCell(c,_)})),_},getFormEditorTemplate:function(e,t){var n=this,d=this.component.columnOption(t.dataField);return function(r,l){var c=(0,o.default)(l);e.row.watch&&e.row.watch((function(){return d.selector(e.row.data)}),(function(){var o,d=c.find(".dx-widget").first(),l=d.data("dxValidator"),f=null===(o=l)||void 0===o?void 0:o.option();c.contents().remove(),e=n.renderFormEditTemplate.bind(n)(e,t,r.component,c),l=(d=c.find(".dx-widget").first()).data("dxValidator"),f&&!l&&d.dxValidator({validationRules:f.validationRules,validationGroup:f.validationGroup,dataGetter:f.dataGetter})})),e=n.renderFormEditTemplate.bind(n)(e,t,r.component,c)}},getEditFormTemplate:function(){var e=this;return function(t,n,d){var r=e.option("editing.form"),l=e.option("editing.form.items"),_=e.option("editing.form.customizeItem"),v=e._editData[(0,E.getIndexByKey)(n.key,e._editData)],C=e.addWidgetPrefix(G),x={};if(l)m(l,(function(e){var t=(null==e?void 0:e.name)||(null==e?void 0:e.dataField);t&&(x[t]=!!e.editorType)}));else{var I=e.getController("columns").getColumns();l=[],(0,h.each)(I,(function(e,t){t.isBand||t.type||l.push({column:t,name:t.name,dataField:t.dataField})}))}if(e._firstFormItem=void 0,e._editForm=e._createComponent((0,o.default)("<div>").appendTo(t),V.default,(0,w.extend)({},r,{items:l,formID:"dx-"+new c.default,validationGroup:v,customizeItem:function(t){var o,d=t.name||t.dataField;if((t.column||d)&&(o=t.column||e._columnsController.columnOption(t.name?"name:"+t.name:"dataField:"+t.dataField)),o){t.label=t.label||{},t.label.text=t.label.text||o.caption,t.template=t.template||e.getFormEditorTemplate(n,t),t.column=o,t.isCustomEditorType=x[d],o.formItem&&(0,w.extend)(t,o.formItem),void 0===t.isRequired&&o.validationRules&&(t.isRequired=o.validationRules.some((function(e){return"required"===e.type})),t.validationRules=[]);var r=!f.default.isDefined(t.visible)||t.visible;!e._firstFormItem&&r&&(e._firstFormItem=t)}_&&_.call(this,t),t.cssClass=f.default.isString(t.cssClass)?t.cssClass+" "+C:C}})),!d){var y=(0,o.default)("<div>").addClass(e.addWidgetPrefix("form-buttons-container")).appendTo(t);e._createComponent((0,o.default)("<div>").appendTo(y),R.default,e._getSaveButtonConfig()),e._createComponent((0,o.default)("<div>").appendTo(y),R.default,e._getCancelButtonConfig())}e._editForm.on("contentReady",(function(){e._editPopup&&e._editPopup.repaint()}))}},getColumnTemplate:function(t){var template,n,o=this,d=t.column,r=t.row&&t.row.rowIndex,l=xe(o),c=o.isEditRow(r),f=o.isEditCell(r,t.columnIndex);!(d.showEditorAlways||d.setCellValue&&(c&&d.allowEditing||f))||"data"!==t.rowType&&"detailAdaptive"!==t.rowType||d.command?"detail"===d.command&&"detail"===t.rowType&&c&&(template=o.getEditFormTemplate(t)):(((o.allowUpdating(t)||c)&&d.allowEditing||f)&&(l&&c||!l)&&(d.showEditorAlways&&!l&&(n={cancel:!1,key:t.row.isNewRow?void 0:t.row.key,data:t.row.data,column:d},o._isEditingStart(n)),n&&n.cancel||(t.setValue=function(e,text){o.updateFieldValue(t,e,text)})),template=d.editCellTemplate||e(o));return template},_createButton:function(e,button,t){var n=this,d=ge[button.name],r=n.option("editing.useIcons"),c=(0,o.default)("<a>").attr("href","#").addClass("dx-link").addClass(button.cssClass);if(button.template)n._rowsView.renderTemplate(e,button.template,t,!0);else{if(r&&d||button.icon){d=button.icon||d;var h=A.default.getImageSourceType(d);"image"===h||"svg"===h?c=A.default.getImageContainer(d).addClass(button.cssClass):c.addClass("dx-icon"+("dxIcon"===h?"-":" ")+d).attr("title",button.text),c.addClass("dx-link-icon"),e.addClass(z);var m=this.getButtonLocalizationNames()[button.name];m&&c.attr("aria-label",y.default.format(m))}else c.text(button.text);f.default.isDefined(button.hint)&&c.attr("title",button.hint),l.default.on(c,(0,x.addNamespace)("click","dxDataGridEditing"),n.createAction((function(e){button.onClick.call(button,(0,w.extend)({},e,{row:t.row,column:t.column})),e.event.preventDefault(),e.event.stopPropagation()}))),e.append(c,"&nbsp;")}},getButtonLocalizationNames:function(){return{edit:"dxDataGrid-editingEditRow",save:"dxDataGrid-editingSaveRowChanges",delete:"dxDataGrid-editingDeleteRow",undelete:"dxDataGrid-editingUndeleteRow",cancel:"dxDataGrid-editingCancelRowChanges"}},prepareEditButtons:function(e){var t=this,n=t.option("editing")||{},d=t.option("editing.texts")||{},r={revert:d.cancelAllChanges,save:d.saveAllChanges,addRow:d.addRow},l={revert:"cancel",save:"save",addRow:"addrow"},c=[],f=function(n,d,c){var f=l[n],h=r[n],w=("save"===f||"cancel"===f)&&!t.hasChanges();return{widget:"dxButton",options:{onInitialized:function(n){(0,o.default)(n.element).addClass(e._getToolbarButtonClass("dx-edit-button "+t.addWidgetPrefix(f)+"-button"))},icon:"edit-button-"+f,disabled:w,onClick:function(){setTimeout((function(){t[d]()}))},text:h,hint:h},showText:"inMenu",name:n+"Button",location:"after",locateInMenu:"auto",sortIndex:c}};return n.allowAdding&&c.push(f("addRow","addRow",20)),(n.allowUpdating||n.allowAdding||n.allowDeleting)&&Ee(t)===ee&&(c.push(f("save","saveEditData",21)),c.push(f("revert","cancelEditData",22))),c},showHighlighting:function(e){var t=e.find(".dx-highlight-outline");"TD"!==e.get(0).tagName||t.length||e.wrapInner((0,o.default)("<div>").addClass("dx-highlight-outline dx-pointer-events-target"))},highlightDataCell:function(e,t){var n=t.setValue;this.isCellModified(t)&&t.column.setCellValue?(this.showHighlighting(e),e.addClass(X)):n&&this.showHighlighting(e)},resetRowAndPageIndices:function(){var e=this;(0,h.each)(e._editData,(function(t,n){n.pageIndex!==e._pageIndex&&(delete n.pageIndex,delete n.rowIndex)}))},_afterInsertRow:function(){},_beforeSaveEditData:function(e){if(e&&!f.default.isDefined(e.key)&&f.default.isDefined(e.type))return!0},_afterSaveEditData:function(){},_beforeCancelEditData:function(){},_allowEditAction:function(e,t){var n=this.option("editing."+e);return f.default.isFunction(n)&&(n=n({component:this.component,row:t.row})),n},allowUpdating:function(e,t){var n=this.option("editing.startEditAction")||le,o=!(arguments.length>1)||(n===t||"down"===t);return o&&this._allowEditAction("allowUpdating",e)},allowDeleting:function(e){return this._allowEditAction("allowDeleting",e)},isCellModified:function(e){var t=e.columnIndex,n=e.row&&(e.row.isNewRow?e.row.values:e.row.modifiedValues);return!!n&&void 0!==n[t]}}}());e.exports={defaultOptions:function(){return{editing:{mode:"row",refreshMode:"full",allowAdding:!1,allowUpdating:!1,allowDeleting:!1,useIcons:!1,selectTextOnEditStart:!1,confirmDelete:!0,texts:{editRow:y.default.format("dxDataGrid-editingEditRow"),saveAllChanges:y.default.format("dxDataGrid-editingSaveAllChanges"),saveRowChanges:y.default.format("dxDataGrid-editingSaveRowChanges"),cancelAllChanges:y.default.format("dxDataGrid-editingCancelAllChanges"),cancelRowChanges:y.default.format("dxDataGrid-editingCancelRowChanges"),addRow:y.default.format("dxDataGrid-editingAddRow"),deleteRow:y.default.format("dxDataGrid-editingDeleteRow"),undeleteRow:y.default.format("dxDataGrid-editingUndeleteRow"),confirmDeleteMessage:y.default.format("dxDataGrid-editingConfirmDeleteMessage"),confirmDeleteTitle:""},form:{colCount:2},popup:{},startEditAction:"click"}}},controllers:{editing:Re},extenders:{controllers:{data:{init:function(){this._editingController=this.getController("editing"),this.callBase()},reload:function(e,t){return!t&&this._editingController.refresh(),this.callBase.apply(this,arguments)},repaintRows:function(){if(!this.getController("editing").isSaving())return this.callBase.apply(this,arguments)},_updateEditRow:function(e){var t=this._editingController,n=e[t.getEditRowIndex()];n&&(n.isEditing=!0,t.getEditMode()===ne&&(n.rowType="detail"))},_updateItemsCore:function(e){this.callBase(e),this._updateEditRow(this.items())},_applyChangeUpdate:function(e){this._updateEditRow(e.items),this.callBase(e)},_applyChangesOnly:function(e){this._updateEditRow(e.items),this.callBase(e)},_processItems:function(e,t){return e=this._editingController.processItems(e,t),this.callBase(e,t)},_processDataItem:function(e,t){return this._editingController.processDataItem(e,t,this.generateDataValues),this.callBase(e,t)},_processItem:function(e,t){return(e=this.callBase(e,t)).isNewRow&&(t.dataIndex--,delete e.dataIndex),e},_correctRowIndices:function(e){this.callBase.apply(this,arguments),this._editingController.correctEditRowIndex(e)},_getChangedColumnIndices:function(e,t,n,o){var d=this.getController("editing"),r=d.isRowEditMode();if(!(e.isNewRow!==t.isNewRow||e.removed!==t.removed||r&&e.isEditing!==t.isEditing))return e.rowType===t.rowType&&r&&d.isEditRow(n)&&o?[]:this.callBase.apply(this,arguments)},_isCellChanged:function(e,t,n,o,d){var r=this.getController("editing"),l=e.cells&&e.cells[o],c=r&&r.isEditCell(n,o);return(!d||!c)&&(!(!l||!l.column||l.column.showEditorAlways||l.isEditing===c)||this.callBase.apply(this,arguments))}}},views:{rowsView:{init:function(){this.callBase(),this._editingController=this.getController("editing")},getCellElements:function(e){var t=this.callBase(e),n=this._editingController,o=n.getEditForm();return n.getEditFormRowIndex()===e&&t&&o?o.$element().find("."+this.addWidgetPrefix(G)+", .dx-button"):t},getCellIndex:function(e,t){if(!e.is("td")&&t>=0){var n=this.getCellElements(t),d=-1;return(0,h.each)(n,(function(t,n){(0,o.default)(n).find(e).length&&(d=t)})),d}return this.callBase.apply(this,arguments)},_getVisibleColumnIndex:function(e,t,n){var o=this._editingController.getEditFormRowIndex();if(o===t&&f.default.isString(n)){var d=this._columnsController.columnOption(n);return this._getEditFormEditorVisibleIndex(e,d)}return this.callBase.apply(this,arguments)},_getEditFormEditorVisibleIndex:function(e,t){var n=-1;return(0,h.each)(e,(function(e,d){var r=(0,o.default)(d).find(".dx-field-item-content").data("dx-form-item");if(r&&r.column&&t&&r.column.index===t.index)return n=e,!1})),n},publicMethods:function(){return this.callBase().concat(["cellValue"])},_getCellTemplate:function(e){return this._editingController.getColumnTemplate(e)||this.callBase(e)},_isNativeClick:function(){return(T.default.real().ios||T.default.real().android)&&this.option("editing.allowUpdating")},_createTable:function(){var e=this,t=e.callBase.apply(e,arguments);return!xe(e)&&e.option("editing.allowUpdating")&&l.default.on(t,(0,x.addNamespace)(B.default.name,"dxDataGridRowsView"),"td:not(.dx-editor-cell)",e.createAction((function(){var t=e._editingController;t.isEditing()&&t.closeEditCell()}))),t},_createRow:function(e){var t=this.callBase(e);if(e){var n=this._editingController.isEditRow(e.rowIndex),o=!!e.removed,d=!!e.isNewRow,r=!!e.modified;Ee(this)===ee?o&&t.addClass("dx-row-removed"):n&&t.addClass($),d&&t.addClass("dx-row-inserted"),r&&t.addClass("dx-row-modified"),(n||d||o)&&t.removeClass(W),n&&"detail"===e.rowType&&t.addClass(this.addWidgetPrefix(M))}return t},_getColumnIndexByElement:function(e){for(var t=e.closest("table"),n=this.getTableElements();t.length&&!n.filter(t).length;)e=t.closest("td"),t=e.closest("table");return this._getColumnIndexByElementCore(e)},_getColumnIndexByElementCore:function(e){var t=e.closest(".dx-row> td:not(.dx-master-detail-cell)");return this.getCellIndex(t)},_editCellByClick:function(e,t){var n=this,d=n._editingController,r=(0,o.default)(e.event.target),l=n._getColumnIndexByElement(r),c=n._dataController.items()[e.rowIndex],f=d.allowUpdating({row:c},t)||c&&c.isNewRow,h=n._columnsController.getVisibleColumns()[l],w=f&&h&&(h.allowEditing||d.isEditCell(e.rowIndex,l)),m=n.option("editing.startEditAction")||"click";return"down"===t?h&&h.showEditorAlways&&w&&d.editCell(e.rowIndex,l):("click"!==t||"dblClick"!==m||d.isEditCell(e.rowIndex,l)||d.closeEditCell(),w&&t===m?d.editCell(e.rowIndex,l)||d.isEditRow(e.rowIndex):void 0)},_rowPointerDown:function(e){var t=this;this._pointerDownTimeout=setTimeout((function(){t._editCellByClick(e,"down")}))},_rowClick:function(e){var t=(0,o.default)(e.rowElement).hasClass(this.addWidgetPrefix(M));e.event.targetComponent=this.component,this._editCellByClick(e,"click")||t||this.callBase.apply(this,arguments)},_rowDblClick:function(e){this._editCellByClick(e,"dblClick")||this.callBase.apply(this,arguments)},_cellPrepared:function(e,t){var n=this._editingController,o=!!t.column.command,d=t.setValue,r=n.isEditRow(t.rowIndex),l=Ie(r,t);if(ye(r,t)){var c=t.column.alignment;e.toggleClass(this.addWidgetPrefix(H),!d).toggleClass(Y,!d),c&&e.find(Q).first().css("textAlign",c)}l&&this._editCellPrepared(e),t.column&&!o&&n.highlightDataCell(e,t),this.callBase.apply(this,arguments)},_editCellPrepared:function(e){},_formItemPrepared:function(){},_isFormItem:function(e){var t="detail"===e.rowType||"detailAdaptive"===e.rowType,n="data"===e.rowType&&"popup"===Ee(this);return(t||n)&&e.item},_updateCell:function(e,t){this._isFormItem(t)?this._formItemPrepared(t,e):this.callBase(e,t)},_update:function(e){this.callBase(e),"updateSelection"===e.changeType&&this.getTableElements().children("tbody").children("."+$).removeClass(W)},_getCellOptions:function(e){var t=this.callBase(e);return t.isEditing=this._editingController.isEditCell(t.rowIndex,t.columnIndex),t},_createCell:function(e){var t=this.callBase(e),n=this._editingController.isEditRow(e.rowIndex);return ye(n,e)&&t.addClass(K),t},_renderCellContent:function(e,t){"data"===t.rowType&&Ee(this)===ae&&!1===t.row.visible||this.callBase.apply(this,arguments)},cellValue:function(e,t,n,text){var o=this.getCellOptions(e,t);if(o){if(void 0===n)return o.value;this._editingController.updateFieldValue(o,n,text,!0)}},dispose:function(){this.callBase.apply(this,arguments),clearTimeout(this._pointerDownTimeout)}},headerPanel:{_getToolbarItems:function(){var e=this.callBase();return this.getController("editing").prepareEditButtons(this).concat(e)},optionChanged:function(e){var t=e.fullName;switch(e.name){case"editing":t&&0===t.indexOf(ve)||this._invalidate(),this.callBase(e);break;default:this.callBase(e)}},isVisible:function(){var e=this.getController("editing").option("editing");return this.callBase()||e&&(e.allowAdding||(e.allowUpdating||e.allowDeleting)&&e.mode===ee)}}}}}}}]);